/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/widgets/scoreboard/v1/scoreboard.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./src/core/basewidget/v2/widget-updater.ts":
/***/ (function(module, exports) {

eval("// Update /////////////////////////////////////////////////////////\r\n(function (scope) {\r\n    var that = {};\r\n    scope['_widget_updater'] = that;\r\n    that._updates = [];\r\n    // that.fps = 60;\r\n    that.time = Date.now();\r\n    that.prevTime = Date.now();\r\n    that._passed = 0;\r\n    that._updateTriggered = false;\r\n    that.addUpdate = function (widget) {\r\n        var updateObject = {};\r\n        updateObject.interval = 0; // TODO\r\n        updateObject.update = function () {\r\n            if (!widget._isVisible) {\r\n                return;\r\n            }\r\n            // if (that.time >= this.time + this.interval) {\r\n            widget.onUpdate(that.time, that._passed);\r\n        };\r\n        that._updates.push(updateObject);\r\n        if (!that._updateTriggered) {\r\n            that._updateTriggered = true;\r\n            that._update();\r\n        }\r\n    };\r\n    that._update = function () {\r\n        requestAnimationFrame(function () {\r\n            that._theUpdate();\r\n            that._update();\r\n        });\r\n    };\r\n    that._theUpdate = function (redraw) {\r\n        var now = Date.now();\r\n        that.time = now;\r\n        that._passed = now - that.prevTime;\r\n        // $._resized = window.innerHeight !== $.screenHeight || window.innerWidth !== $.screenWidth;\r\n        // $.screenWidth = window.innerWidth;\r\n        // $.screenHeight = window.innerHeight;\r\n        // $._interval = ((1 / fps) * 1000);\r\n        that._updates.forEach(function (updateObject) {\r\n            updateObject.update();\r\n        });\r\n        that.prevTime = now;\r\n    };\r\n})(window);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29yZS9iYXNld2lkZ2V0L3YyL3dpZGdldC11cGRhdGVyLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2NvcmUvYmFzZXdpZGdldC92Mi93aWRnZXQtdXBkYXRlci50cz80OWI0Il0sInNvdXJjZXNDb250ZW50IjpbIlxyXG4vLyBVcGRhdGUgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4oZnVuY3Rpb24oc2NvcGUpIHtcclxuICAgIGNvbnN0IHRoYXQgPSB7fSBhcyBhbnk7XHJcbiAgICBzY29wZVsnX3dpZGdldF91cGRhdGVyJ10gPSB0aGF0O1xyXG5cclxuICAgIHRoYXQuX3VwZGF0ZXMgPSBbXTtcclxuXHJcbiAgICAvLyB0aGF0LmZwcyA9IDYwO1xyXG5cclxuICAgIHRoYXQudGltZSA9IERhdGUubm93KCk7XHJcbiAgICB0aGF0LnByZXZUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgIHRoYXQuX3Bhc3NlZCA9IDA7XHJcbiAgICB0aGF0Ll91cGRhdGVUcmlnZ2VyZWQgPSBmYWxzZTtcclxuXHJcbiAgICB0aGF0LmFkZFVwZGF0ZSA9IGZ1bmN0aW9uKHdpZGdldCkge1xyXG4gICAgICAgIGNvbnN0IHVwZGF0ZU9iamVjdCA9IHt9IGFzIGFueTtcclxuICAgICAgICB1cGRhdGVPYmplY3QuaW50ZXJ2YWwgPSAwOyAvLyBUT0RPXHJcblxyXG4gICAgICAgIHVwZGF0ZU9iamVjdC51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCF3aWRnZXQuX2lzVmlzaWJsZSkgeyByZXR1cm47IH1cclxuXHJcbiAgICAgICAgICAgIC8vIGlmICh0aGF0LnRpbWUgPj0gdGhpcy50aW1lICsgdGhpcy5pbnRlcnZhbCkge1xyXG4gICAgICAgICAgICB3aWRnZXQub25VcGRhdGUodGhhdC50aW1lLCB0aGF0Ll9wYXNzZWQpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoYXQuX3VwZGF0ZXMucHVzaCh1cGRhdGVPYmplY3QpO1xyXG4gICAgICAgIGlmICghdGhhdC5fdXBkYXRlVHJpZ2dlcmVkKSB7XHJcbiAgICAgICAgICAgIHRoYXQuX3VwZGF0ZVRyaWdnZXJlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoYXQuX3VwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdGhhdC5fdXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGF0Ll90aGVVcGRhdGUoKTtcclxuICAgICAgICAgICAgdGhhdC5fdXBkYXRlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoYXQuX3RoZVVwZGF0ZSA9IGZ1bmN0aW9uKHJlZHJhdykge1xyXG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgdGhhdC50aW1lID0gbm93O1xyXG4gICAgICAgIHRoYXQuX3Bhc3NlZCA9IG5vdyAtIHRoYXQucHJldlRpbWU7XHJcblxyXG4gICAgICAgIC8vICQuX3Jlc2l6ZWQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgIT09ICQuc2NyZWVuSGVpZ2h0IHx8IHdpbmRvdy5pbm5lcldpZHRoICE9PSAkLnNjcmVlbldpZHRoO1xyXG4gICAgICAgIC8vICQuc2NyZWVuV2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICAvLyAkLnNjcmVlbkhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuXHJcbiAgICAgICAgLy8gJC5faW50ZXJ2YWwgPSAoKDEgLyBmcHMpICogMTAwMCk7XHJcblxyXG4gICAgICAgIHRoYXQuX3VwZGF0ZXMuZm9yRWFjaChmdW5jdGlvbih1cGRhdGVPYmplY3QpIHtcclxuICAgICAgICAgICAgdXBkYXRlT2JqZWN0LnVwZGF0ZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGF0LnByZXZUaW1lID0gbm93O1xyXG4gICAgfVxyXG59KSh3aW5kb3cpO1xyXG4iXSwibWFwcGluZ3MiOiJBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/core/basewidget/v2/widget-updater.ts\n");

/***/ }),

/***/ "./src/core/basewidget/v2/widget.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__webpack_require__(\"./src/core/basewidget/v2/widget-updater.ts\");\r\nvar Widget = /** @class */ (function () {\r\n    function Widget(_id, _version, _systemSettings) {\r\n        this._id = _id;\r\n        this._version = _version;\r\n        this._systemSettings = _systemSettings;\r\n        this._rendered = false;\r\n        this._isVisible = false;\r\n        this._hasStarted = false;\r\n        this._pageId = _systemSettings.pageId;\r\n        this._events = {};\r\n        this._setupMethods = this._setupMethods || {};\r\n        this._startMethods = this._startMethods || {};\r\n        this._stopMethods = this._stopMethods || {};\r\n        this._rootEl = $('<div>')\r\n            .addClass('spwidget')\r\n            .addClass(_id)\r\n            .attr('data-version', this._version)\r\n            .attr('data-widget', _id);\r\n        this.init();\r\n        // TODO: Work out what this nonsense is and preferably remove it (only appears to be used by imagecomp)\r\n        if (this.onUpdate && window._widget_updater) {\r\n            window._widget_updater.addUpdate(this);\r\n        }\r\n    }\r\n    // Config /////////////////////////////////////////////////////\r\n    Widget.prototype.addSetupMethod = function (key, method) {\r\n        this._setupMethods[key] = method;\r\n    };\r\n    Widget.prototype.addStartMethod = function (key, method) {\r\n        this._startMethods[key] = method;\r\n    };\r\n    Widget.prototype.addStopMethod = function (key, method) {\r\n        this._stopMethods[key] = method;\r\n    };\r\n    Widget.prototype.setSettings = function (s) {\r\n        this._rendered = false;\r\n        this._hasStarted = false;\r\n        this._settings = s;\r\n        this.refresh();\r\n        this.onReady();\r\n    };\r\n    // Obsolete: do not use! To be removed!\r\n    Widget.prototype.s = function (key, backup) {\r\n        return this.getSetting(key, backup);\r\n    };\r\n    Widget.prototype.getSettings = function () {\r\n        return this._settings;\r\n    };\r\n    // Interface //////////////////////////////////////////////////\r\n    Widget.prototype.showMyPage = function () {\r\n        this.getInterface().requestShowMyPage();\r\n    };\r\n    Widget.prototype.getSystemSettings = function () {\r\n        return this._systemSettings;\r\n    };\r\n    Widget.prototype.getInterface = function () {\r\n        return this._systemSettings.playProxy;\r\n    };\r\n    Widget.prototype.getEnvironment = function () {\r\n        return (this._systemSettings.mode || 'player_live');\r\n    };\r\n    Widget.prototype.getCurrentPageId = function () {\r\n        return this.getInterface().getCurrentPageId();\r\n    };\r\n    Widget.prototype.inAdmin = function () {\r\n        return this.getEnvironment() === 'admin';\r\n    };\r\n    Widget.prototype.inTesting = function () {\r\n        return this.getEnvironment() === 'player_testing';\r\n    };\r\n    Widget.prototype.inLive = function () {\r\n        return this.getEnvironment() === 'player_live';\r\n    };\r\n    Widget.prototype.validate = function (options) {\r\n        // success, error, currentWidgetOnly:true, currentPageOnly\r\n        options = options || {};\r\n        if (!options.hasOwnProperty('currentPage') &&\r\n            !options.hasOwnProperty('currentSection') &&\r\n            !options.hasOwnProperty('currentWidgetOnly')) {\r\n            options.currentWidgetOnly = true;\r\n        }\r\n        return this.getInterface().validate(options);\r\n    };\r\n    Widget.prototype.submit = function (options) {\r\n        // success, error, currentWidgetOnly:true, currentPageOnly\r\n        options = options || {};\r\n        if (!options.hasOwnProperty('currentPage') &&\r\n            !options.hasOwnProperty('currentSection') &&\r\n            !options.hasOwnProperty('currentWidgetOnly')) {\r\n            options.currentWidgetOnly = true;\r\n        }\r\n        return this.getInterface().submit(options);\r\n    };\r\n    Widget.prototype.submitAsync = function (data, currentPage, currentSection, currentWidgetOnly, nextPageId, progress) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!currentPage && !currentSection && !currentWidgetOnly) {\r\n                currentWidgetOnly = true;\r\n            }\r\n            _this.getInterface().submit({\r\n                data: data,\r\n                currentPage: currentPage,\r\n                currentSection: currentSection,\r\n                currentWidgetOnly: currentWidgetOnly,\r\n                nextPageId: nextPageId,\r\n                progress: progress,\r\n                success: function (submissionResult) {\r\n                    resolve(submissionResult);\r\n                },\r\n                error: function (submissionResult) {\r\n                    reject(submissionResult);\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Widget.prototype.goToLink = function (href, newTab) {\r\n        href = href || this._settings.href;\r\n        if (newTab === false) {\r\n            window.location.href = href;\r\n        }\r\n        else {\r\n            window.open(href, '_blank');\r\n        }\r\n    };\r\n    Widget.prototype.goToPage = function (pageId) {\r\n        pageId = pageId || this.getSetting('nextPageId');\r\n        this.getInterface().showPage(pageId);\r\n    };\r\n    Widget.prototype.getPromotionId = function () {\r\n        return this.getSystemSettings().promotion.id;\r\n    };\r\n    Widget.prototype.getPromotionShortId = function () {\r\n        return this.getSystemSettings().promotion.shortId;\r\n    };\r\n    Widget.prototype.getSessionId = function () {\r\n        return this.getSystemSettings().sessionId;\r\n    };\r\n    Widget.prototype.getWidgetHolderId = function () {\r\n        return this.getWidgetId();\r\n    };\r\n    Widget.prototype.getWidgetId = function () {\r\n        return this.getSystemSettings().widgetId;\r\n    };\r\n    Widget.prototype.getWidgetName = function () {\r\n        return this._id;\r\n    };\r\n    Widget.prototype.getWidgetVersion = function () {\r\n        return this._version;\r\n    };\r\n    Widget.prototype.getServerDateTime = function () {\r\n        return this.getInterface().getTime();\r\n    };\r\n    Widget.prototype.getPromotionStartDateTime = function () {\r\n        return this.getSystemSettings().promotion.startDate;\r\n    };\r\n    Widget.prototype.getPromotionCloseDateTime = function () {\r\n        return this.getSystemSettings().promotion.closeDate;\r\n    };\r\n    Widget.prototype.getActiveStateValueId = function (stateId) {\r\n        return this.getInterface().getActiveStateValueId(stateId);\r\n    };\r\n    Widget.prototype.changeStateValue = function (stateId, stateValueId) {\r\n        stateId = stateId || this.s('setStateId');\r\n        if (!stateId) {\r\n            return;\r\n        }\r\n        stateValueId = stateValueId || this.s('setStateValueId') || null;\r\n        // if (!stateValueId) return;\r\n        return this.setActiveStateValueId(stateId, stateValueId);\r\n    };\r\n    Widget.prototype.setActiveStateValueId = function (stateId, stateValueId) {\r\n        return this.getInterface().setActiveStateValueId(stateId, stateValueId);\r\n    };\r\n    Widget.prototype.getWidgetRootUrl = function () {\r\n        return this.getSystemSettings().urls.widget;\r\n    };\r\n    Widget.prototype.getAPIUrl = function () {\r\n        return this.getSystemSettings().urls.api;\r\n    };\r\n    Widget.prototype.getResourceUrl = function () {\r\n        return this.getSystemSettings().urls.resources;\r\n    };\r\n    Widget.prototype.getServiceUrl = function () {\r\n        return this.getSystemSettings().urls.services;\r\n    };\r\n    Widget.prototype.isConnectedToNetwork = function (options) {\r\n        this.getInterface().isConnectedToNetwork(options);\r\n    };\r\n    // Widget Communication ///////////////////////////////////////\r\n    Widget.prototype.getSharedValueStore = function () {\r\n        return this.getSystemSettings().sharedValueStore;\r\n    };\r\n    Widget.prototype.assignSharedValue = function (key, data) {\r\n        if (!key) {\r\n            return null;\r\n        }\r\n        var sharedValueStore = this.getSharedValueStore();\r\n        sharedValueStore.set(key, data);\r\n    };\r\n    Widget.prototype.getSharedValue = function (key) {\r\n        if (!key) {\r\n            return null;\r\n        }\r\n        var sharedValueStore = this.getSharedValueStore();\r\n        return sharedValueStore.get(key);\r\n    };\r\n    Widget.prototype.getSavedProgress = function () {\r\n        if (this.getInterface().getSavedProgress) {\r\n            return this.getInterface().getSavedProgress();\r\n        }\r\n        else {\r\n            return localStorage;\r\n        }\r\n    };\r\n    Widget.prototype.getSavedProgressValue = function (key) {\r\n        var savedData = this.getSavedProgress();\r\n        if (savedData && savedData.hasOwnProperty(key)) {\r\n            return savedData[key];\r\n        }\r\n        return null;\r\n    };\r\n    Widget.prototype.onSavedProgressUpdated = function () {\r\n        // Override me\r\n    };\r\n    Widget.prototype.saveProgress = function (key, data) {\r\n        if (!key) {\r\n            return;\r\n        }\r\n        if (this.getInterface().hasOwnProperty('getSavedProgress')) {\r\n            // this.getInterface().getSavedProgress()[key] = value;\r\n            this.submit({\r\n                currentWidgetOnly: true,\r\n                data: {\r\n                    key: key,\r\n                    data: data\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.storeLocalStorage(key, data);\r\n        }\r\n    };\r\n    Widget.prototype.storePromotionData = function (key, data) {\r\n        this.storeLocalStorage(this.getPromotionId() + '_' + key, data);\r\n    };\r\n    Widget.prototype.getPromotionData = function (key) {\r\n        return this.getLocalStorage(this.getPromotionId() + '_' + key);\r\n    };\r\n    // Utility ////////////////////////////////////////////////////\r\n    Widget.prototype.visible = function () {\r\n        return this._isVisible;\r\n    };\r\n    Widget.prototype.log = function (message, e) {\r\n        if (!this.inLive()) {\r\n            this.getInterface().log(message);\r\n        }\r\n    };\r\n    Widget.prototype.findCurlyKeys = function (string) {\r\n        var found = [];\r\n        var rxp = /{([^}]+)}/g;\r\n        var curMatch;\r\n        while (curMatch = rxp.exec(string)) {\r\n            found.push(curMatch[1]);\r\n        }\r\n        return found;\r\n    };\r\n    Widget.prototype.getPromotionSharingURL = function () {\r\n        return this.getSystemSettings().promotion.shareUrl;\r\n    };\r\n    Widget.prototype.getPromotionSharingURLDirect = function () {\r\n        return this.getSystemSettings().promotion.shareUrlDirect;\r\n    };\r\n    Widget.prototype.getTestingStates = function () {\r\n        // Used for widget testing\r\n        return this;\r\n    };\r\n    Widget.prototype.storeLocalStorage = function (key, data) {\r\n        var storageMethod = localStorage;\r\n        try {\r\n            if (storageMethod && key && data) {\r\n                storageMethod[key] = JSON.stringify(data);\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        catch (ex) {\r\n            return false;\r\n        }\r\n    };\r\n    Widget.prototype.getLocalStorage = function (key) {\r\n        var storageMethod = localStorage;\r\n        try {\r\n            if (storageMethod && key) {\r\n                return storageMethod[key];\r\n            }\r\n            return null;\r\n        }\r\n        catch (ex) {\r\n            return null;\r\n        }\r\n    };\r\n    Widget.prototype.bind = function (key, callback, id) {\r\n        if (!callback) {\r\n            return;\r\n        }\r\n        key = key.replace('.', '_');\r\n        if (id) {\r\n            var that_1 = this;\r\n            that_1._events[id] = true;\r\n            $('body').on(key, function () {\r\n                if (that_1._events[id]) {\r\n                    callback.call(this, arguments);\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            $('body').on(key, callback);\r\n        }\r\n    };\r\n    Widget.prototype.on = function (key, callback) {\r\n        this.bind(key, callback);\r\n    };\r\n    Widget.prototype.unbind = function (id) {\r\n        if (!id) {\r\n            return;\r\n        }\r\n        this._events[id] = false;\r\n    };\r\n    Widget.prototype.trigger = function (key, data) {\r\n        // Data should be an array\r\n        key = key.replace('.', '_');\r\n        $('body').trigger(key, data);\r\n    };\r\n    Widget.prototype.interfaceAddEventListener = function (eventId, listenerId, callback) {\r\n        // TODO Add enum for system events\r\n        this.getInterface().addEventListener(eventId, listenerId, callback);\r\n    };\r\n    Widget.prototype.interfaceRemoveEventListener = function (eventId, listenerId) {\r\n        this.getInterface().removeEventListener(eventId, listenerId);\r\n    };\r\n    Widget.prototype.interfaceFireEvent = function (eventId, data) {\r\n        this.getInterface().fireEvent(eventId, data);\r\n    };\r\n    Widget.prototype.getProxiedUrl = function (url) {\r\n        if (url.indexOf('http') !== 0) {\r\n            var protocol = window.location.protocol;\r\n            if (protocol === 'about:') {\r\n                protocol = 'http:'; // This may be just as invalid, of course\r\n            }\r\n            url = protocol + url;\r\n        }\r\n        return this.getSystemSettings().urls.proxy + '?url=' + encodeURIComponent(url);\r\n    };\r\n    Widget.prototype.loadScript = function (scriptUrl, callback) {\r\n        this.getInterface().loadScript(scriptUrl, callback);\r\n    };\r\n    Widget.prototype.loadScriptAsync = function (scriptUrl) {\r\n        return __awaiter(this, void 0, Promise, function () {\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, new Promise(function (resolve, reject) {\r\n                            _this.getInterface().loadScript(scriptUrl, function () {\r\n                                resolve();\r\n                            });\r\n                        })];\r\n                    case 1:\r\n                        _a.sent();\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Widget.prototype.loadStyle = function (styleUrl) {\r\n        this.getInterface().loadStyle(styleUrl);\r\n    };\r\n    Widget.prototype.isMobile = function () {\r\n        return /Android/i.test(navigator.userAgent) || /iPhone|iPad|iPod/i.test(navigator.userAgent);\r\n    };\r\n    Widget.prototype.debounce = function (func, wait, immediate) {\r\n        var timeout;\r\n        return function () {\r\n            var context = this;\r\n            var args = arguments;\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(function () {\r\n                timeout = null;\r\n                if (!immediate) {\r\n                    func.apply(context, args);\r\n                }\r\n            }, wait);\r\n            if (immediate && !timeout) {\r\n                func.apply(context, args);\r\n            }\r\n        };\r\n    };\r\n    // Analytics //////////////////////////////////////////////////\r\n    Widget.prototype.track = function (eventId, eventData) {\r\n        this.getInterface().trackEvent(eventId, eventData);\r\n    };\r\n    Widget.prototype.setCookieConsentAcknowledged = function () {\r\n        this.getInterface().setCookieConsentAcknowledged();\r\n    };\r\n    Widget.prototype.setCookieConsentAccepted = function () {\r\n        this.getInterface().setCookieConsentAccepted();\r\n    };\r\n    Widget.prototype.openCookieConsentSettings = function () {\r\n        this.getInterface().openCookieConsentSettings();\r\n    };\r\n    // Root ///////////////////////////////////////////////////////\r\n    Widget.prototype.f = function (query) {\r\n        if (query) {\r\n            return this.getRoot().find(query);\r\n        }\r\n        return this._rootEl;\r\n    };\r\n    Widget.prototype.getRoot = function () {\r\n        return this._rootEl;\r\n    };\r\n    Widget.prototype.classify = function (str) {\r\n        return str.trim().toLowerCase().replace(/\\s/g, '_');\r\n    };\r\n    Widget.prototype.findNestedValue = function (obj, nestedKey) {\r\n        if (!obj || !nestedKey) {\r\n            return null;\r\n        }\r\n        var tokens = nestedKey.split('.');\r\n        for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\r\n            var token = tokens_1[_i];\r\n            obj = obj[token];\r\n            if (obj == null) {\r\n                return null;\r\n            }\r\n        }\r\n        return obj;\r\n    };\r\n    Widget.prototype.replaceDynamicVariables = function (str) {\r\n        // Replace {score} with actual score (50)\r\n        var that = this;\r\n        if (str && typeof (str) === 'string' && str.indexOf('{') > -1) {\r\n            var found = this.findCurlyKeys(str);\r\n            found.forEach(function (varReplace) {\r\n                var value = that.getSharedValue(varReplace);\r\n                if (!value && value !== false && value !== 0) {\r\n                    if (varReplace === 'terms' || varReplace === 'privacy') {\r\n                        return;\r\n                    }\r\n                    value = '';\r\n                }\r\n                if (that.inAdmin()) {\r\n                    if ((varReplace.indexOf('score') > -1) ||\r\n                        (varReplace.indexOf('total') === 0)) {\r\n                        value = '000';\r\n                    }\r\n                    if (varReplace.indexOf('time') === 0) {\r\n                        value = '00:00';\r\n                    }\r\n                }\r\n                str = str.replace('{' + varReplace + '}', value);\r\n            });\r\n        }\r\n        return str;\r\n    };\r\n    Widget.prototype.cleanHTML = function () {\r\n        this.getRoot().empty();\r\n        var newHTML = this.getHTML();\r\n        if (newHTML) {\r\n            if (!this._dontReplaceHTML) {\r\n                this._lastReplaceHTML = newHTML;\r\n                newHTML = this.replaceDynamicVariables(newHTML);\r\n            }\r\n            this.getRoot().append(newHTML);\r\n        }\r\n        this._rendered = true;\r\n    };\r\n    Widget.prototype.getHTML = function () {\r\n        // Override me\r\n        return $('');\r\n    };\r\n    Widget.prototype.refresh = function () {\r\n        this.cleanHTML();\r\n        for (var _i = 0, _a = this._setupMethods; _i < _a.length; _i++) {\r\n            var method = _a[_i];\r\n            this._setupMethods[method].call(this);\r\n        }\r\n        this.onSetup();\r\n    };\r\n    Widget.prototype.simulate = function () {\r\n        // Override me\r\n    };\r\n    // Data ///////////////////////////////////////////////////////\r\n    Widget.prototype.validateSubmissionData = function () {\r\n        // Override\r\n        return {\r\n            valid: true,\r\n            errors: []\r\n        };\r\n    };\r\n    Widget.prototype.getSubmissionData = function () {\r\n        // Override\r\n        return void 0;\r\n    };\r\n    // Functionality //////////////////////////////////////////////\r\n    Widget.prototype.init = function () {\r\n        // Override me\r\n        // PRE-SETTING STATE\r\n    };\r\n    Widget.prototype.onReady = function () {\r\n        // Override me\r\n        // HAS SETTINGS, NOT RENDERED\r\n    };\r\n    Widget.prototype.onSetup = function () {\r\n        // Override me\r\n    };\r\n    Widget.prototype.start = function () {\r\n        if (!this._rendered) {\r\n            this.refresh();\r\n        }\r\n        for (var _i = 0, _a = this._startMethods; _i < _a.length; _i++) {\r\n            var method = _a[_i];\r\n            this._startMethods[method].call(this);\r\n        }\r\n        this.onShow();\r\n        this._isVisible = true;\r\n        this._hasStarted = true;\r\n    };\r\n    Widget.prototype.stop = function () {\r\n        for (var _i = 0, _a = this._stopMethods; _i < _a.length; _i++) {\r\n            var method = _a[_i];\r\n            this._stopMethods[method].call(this);\r\n        }\r\n        this.onHide();\r\n        this._isVisible = false;\r\n    };\r\n    Widget.prototype.onEditorAdded = function (event) {\r\n    };\r\n    Widget.prototype.onEditorRefresh = function (event) {\r\n    };\r\n    Widget.prototype.onShow = function () {\r\n        // Override me\r\n    };\r\n    Widget.prototype.onHide = function () {\r\n        // Override me\r\n    };\r\n    Widget.prototype.update = function () {\r\n        // Add an .onUpdate method in widget\r\n    };\r\n    Widget.prototype.find = function (query) {\r\n        return this.f(query);\r\n    };\r\n    Widget.prototype.getSetting = function (key, backup) {\r\n        if (!this._settings) {\r\n            return backup;\r\n        }\r\n        var theSetting = this._settings[key];\r\n        if (theSetting === null || theSetting === undefined) {\r\n            return backup;\r\n        }\r\n        return theSetting;\r\n    };\r\n    Widget.prototype.getSharedSetting = function (key, settingsWidgetId, backup) {\r\n        var settings = this.getSettingsForWidget(settingsWidgetId);\r\n        if (settings === null || settings === undefined) {\r\n            return this.getSetting(key, backup);\r\n        }\r\n        var theSetting = settings[key];\r\n        if (theSetting === null || theSetting === undefined) {\r\n            return backup;\r\n        }\r\n        return theSetting;\r\n    };\r\n    Widget.prototype.getRequiredNetworkScopes = function (network) {\r\n        return [];\r\n    };\r\n    Widget.prototype.getRequiredNetworks = function () {\r\n        return [];\r\n    };\r\n    Widget.prototype.isStarted = function () {\r\n        return true;\r\n    };\r\n    Widget.prototype.setShareableVariableKeys = function (keys) {\r\n        var key = 'shareablekeys_' + this.getWidgetName();\r\n        this.getSharedValueStore().set(key, keys);\r\n    };\r\n    Widget.prototype.getWidget = function (widgetId) {\r\n        return this.getInterface().getWidget(widgetId);\r\n    };\r\n    Widget.prototype.getSettingsForWidget = function (widgetId) {\r\n        return this.getInterface().getSettingsForWidget(widgetId);\r\n    };\r\n    Widget.prototype.isConnectedToNetworkAsync = function (network, submissionData) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.getInterface().isConnectedToNetwork({\r\n                network: network,\r\n                submissionData: submissionData,\r\n                success: function (credentials) {\r\n                    _this.track('already_connected', { network: network });\r\n                    resolve(credentials);\r\n                },\r\n                error: function () {\r\n                    reject();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Widget.prototype.connectToNetworkAsync = function (network, submissionData) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.track('connect', network);\r\n            _this.getInterface().connectToNetwork({\r\n                network: network,\r\n                submissionData: submissionData,\r\n                success: function (credentials) {\r\n                    _this.track('connected', network);\r\n                    resolve(credentials);\r\n                },\r\n                error: function () {\r\n                    reject();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Widget.prototype.refreshTokenAsync = function (network, submissionData) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            _this.getInterface().refreshToken({\r\n                network: network,\r\n                submissionData: submissionData,\r\n                success: function (credentials) {\r\n                    resolve(credentials);\r\n                },\r\n                error: function () {\r\n                    reject();\r\n                }\r\n            });\r\n        });\r\n    };\r\n    Widget.prototype.isInAppBrowserRedirect = function () {\r\n        return (location.search.indexOf('cc_connect=') !== -1)\r\n            || (document.referrer === 'https://authorize.music.apple.com/loading');\r\n    };\r\n    return Widget;\r\n}());\r\nexports.Widget = Widget;\r\nSocialPromote.Widgets.coreV2 = Widget;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29yZS9iYXNld2lkZ2V0L3YyL3dpZGdldC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9jb3JlL2Jhc2V3aWRnZXQvdjIvd2lkZ2V0LnRzPzdmN2IiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tICdzaGFyZWQvbW9kZWwvZW52aXJvbm1lbnQubW9kZWwnO1xyXG5pbXBvcnQgeyBOZXR3b3JrQ3JlZGVudGlhbHMgfSBmcm9tICdzaGFyZWQvbW9kZWwvbmV0d29ya3MvbmV0d29yay1jcmVkZW50aWFscy5tb2RlbCc7XHJcbmltcG9ydCB7IE5ldHdvcmsgfSBmcm9tICdzaGFyZWQvbW9kZWwvbmV0d29ya3MvbmV0d29yay5tb2RlbCc7XHJcbmltcG9ydCB7IFBsYXllclN1Ym1pc3Npb25EYXRhIH0gZnJvbSAnc2hhcmVkL21vZGVsL3BsYXllci1kYXRhL3BsYXllci1zdWJtaXNzaW9uLWRhdGEubW9kZWwnO1xyXG5pbXBvcnQgeyBXaWRnZXRSdW50aW1lT3B0aW9ucyB9IGZyb20gJ3NoYXJlZC9tb2RlbC93aWRnZXQtYXBpL3dpZGdldC1ydW50aW1lLW9wdGlvbnMubW9kZWwnO1xyXG5pbXBvcnQgeyBXaWRnZXREZXNpZ25lckV2ZW50IH0gZnJvbSAnc2hhcmVkL21vZGVsL3dpZGdldHMvd2lkZ2V0LWRlc2lnbmVyLWV2ZW50JztcclxuaW1wb3J0IHsgV2lkZ2V0U2V0dGluZ3MgfSBmcm9tICdzaGFyZWQvbW9kZWwvd2lkZ2V0cy93aWRnZXQtc2V0dGluZ3MubW9kZWwnO1xyXG5pbXBvcnQgeyBUcmFja0V2ZW50RGF0YSwgVHJhY2tFdmVudEV2ZW50SWQgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9Db3JlL21vZGVsL2FuYWx5dGljcy90cmFjay1ldmVudCc7XHJcbmltcG9ydCB7IFN1Ym1pc3Npb25EYXRhVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL0NvcmUvbW9kZWwvcGxheWVyLWRhdGEvc3VibWlzc2lvbi1kYXRhLXZhbGlkYXRpb24tcmVzdWx0Lm1vZGVsJztcclxuaW1wb3J0IHsgU3VibWlzc2lvblJlc3VsdCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL0NvcmUvbW9kZWwvc3VibWlzc2lvbnMvc3VibWlzc2lvbi1yZXN1bHQubW9kZWwnO1xyXG5pbXBvcnQgeyBEYXRlVGltZU9mZnNldCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL0NvcmUvbW9kZWwvdXRpbHMvZGF0ZS10aW1lLW9mZnNldCc7XHJcbmltcG9ydCB7IFNoYXJlZFZhbHVlU3RvcmUgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9Db3JlL21vZGVsL3dpZGdldC1hcGkvc2hhcmVkLXZhbHVlLXN0b3JlLm1vZGVsJztcclxuaW1wb3J0IHsgU29jaWFsQ29ubmVjdE9wdGlvbnMgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9Db3JlL21vZGVsL3dpZGdldC1hcGkvc29jaWFsLWNvbm5lY3Qtb3B0aW9ucy5tb2RlbCc7XHJcbmltcG9ydCB7IFN1Ym1pc3Npb25PcHRpb25zIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vQ29yZS9tb2RlbC93aWRnZXQtYXBpL3N1Ym1pc3Npb24tb3B0aW9ucy5tb2RlbCc7XHJcbmltcG9ydCB7IFdpZGdldEFwaSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL0NvcmUvbW9kZWwvd2lkZ2V0LWFwaS93aWRnZXQtYXBpLm1vZGVsJztcclxuaW1wb3J0IHsgUHJvZ3Jlc3NMaXN0ZW5lciB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL0NvcmUvc2VydmljZXMvcHJvZ3Jlc3MtaHR0cC9wcm9ncmVzcy1saXN0ZW5lci5tb2RlbCc7XHJcbmltcG9ydCB7IFNlbWFudGljRmllbGRJdGVtU2V0dGluZ3MgfSBmcm9tICcuLi8uLi8uLi93aWRnZXRzL3NlbWFudGljX2ZpZWxkL3YxL3NlbWFudGljX2ZpZWxkLXNldHRpbmdzJztcclxuaW1wb3J0IHsgUXVlc3Rpb25EYXRhIH0gZnJvbSAnLi4vLi4vY29tbW9uL211c2ljLXNlcnZpY2VzL3F1aXovcXVlc3Rpb24tZGF0YSc7XHJcbmltcG9ydCAnLi93aWRnZXQtdXBkYXRlcic7XHJcbmltcG9ydCB7IFdpZGdldFYyIH0gZnJvbSAnLi93aWRnZXRWMic7XHJcblxyXG5kZWNsYXJlIHZhciBTb2NpYWxQcm9tb3RlO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdpZGdldDxUU2V0dGluZ3MgZXh0ZW5kcyBXaWRnZXRTZXR0aW5ncz4gaW1wbGVtZW50cyBXaWRnZXRWMjxUU2V0dGluZ3M+IHtcclxuXHJcbiAgICBwcml2YXRlIF9wYWdlSWQ7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9ldmVudHM7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9zZXR1cE1ldGhvZHM7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9zdGFydE1ldGhvZHM7XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9zdG9wTWV0aG9kcztcclxuICAgIHByaXZhdGUgX3JlbmRlcmVkID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIF9pc1Zpc2libGUgPSBmYWxzZTtcclxuICAgIHByaXZhdGUgX2hhc1N0YXJ0ZWQgPSBmYWxzZTtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgX3Jvb3RFbDogSlF1ZXJ5O1xyXG4gICAgcHJpdmF0ZSBfc2V0dGluZ3M6IFRTZXR0aW5ncztcclxuICAgIHByaXZhdGUgX2xhc3RSZXBsYWNlSFRNTDogSlF1ZXJ5IHwgc3RyaW5nIHwgUHJvbWlzZTxKUXVlcnk+O1xyXG4gICAgcHJpdmF0ZSBfZG9udFJlcGxhY2VIVE1MOiBib29sZWFuO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgX2lkOiBzdHJpbmcsXHJcbiAgICAgICAgcHJpdmF0ZSBfdmVyc2lvbjogbnVtYmVyLFxyXG4gICAgICAgIHByaXZhdGUgX3N5c3RlbVNldHRpbmdzOiBXaWRnZXRSdW50aW1lT3B0aW9ucykge1xyXG5cclxuICAgICAgICB0aGlzLl9wYWdlSWQgPSBfc3lzdGVtU2V0dGluZ3MucGFnZUlkO1xyXG4gICAgICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX3NldHVwTWV0aG9kcyA9IHRoaXMuX3NldHVwTWV0aG9kcyB8fCB7fTtcclxuICAgICAgICB0aGlzLl9zdGFydE1ldGhvZHMgPSB0aGlzLl9zdGFydE1ldGhvZHMgfHwge307XHJcbiAgICAgICAgdGhpcy5fc3RvcE1ldGhvZHMgPSB0aGlzLl9zdG9wTWV0aG9kcyB8fCB7fTtcclxuICAgICAgICB0aGlzLl9yb290RWwgPSAkKCc8ZGl2PicpXHJcbiAgICAgICAgICAgIC5hZGRDbGFzcygnc3B3aWRnZXQnKVxyXG4gICAgICAgICAgICAuYWRkQ2xhc3MoX2lkKVxyXG4gICAgICAgICAgICAuYXR0cignZGF0YS12ZXJzaW9uJywgdGhpcy5fdmVyc2lvbilcclxuICAgICAgICAgICAgLmF0dHIoJ2RhdGEtd2lkZ2V0JywgX2lkKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0KCk7XHJcblxyXG4gICAgICAgIC8vIFRPRE86IFdvcmsgb3V0IHdoYXQgdGhpcyBub25zZW5zZSBpcyBhbmQgcHJlZmVyYWJseSByZW1vdmUgaXQgKG9ubHkgYXBwZWFycyB0byBiZSB1c2VkIGJ5IGltYWdlY29tcClcclxuICAgICAgICBpZiAoKHRoaXMgYXMgYW55KS5vblVwZGF0ZSAmJiAod2luZG93IGFzIGFueSkuX3dpZGdldF91cGRhdGVyKSB7XHJcbiAgICAgICAgICAgICh3aW5kb3cgYXMgYW55KS5fd2lkZ2V0X3VwZGF0ZXIuYWRkVXBkYXRlKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBDb25maWcgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICBwdWJsaWMgYWRkU2V0dXBNZXRob2Qoa2V5OiBzdHJpbmcsIG1ldGhvZDogKCkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3NldHVwTWV0aG9kc1trZXldID0gbWV0aG9kO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhZGRTdGFydE1ldGhvZChrZXk6IHN0cmluZywgbWV0aG9kOiAoKSA9PiB2b2lkKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fc3RhcnRNZXRob2RzW2tleV0gPSBtZXRob2Q7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFkZFN0b3BNZXRob2Qoa2V5OiBzdHJpbmcsIG1ldGhvZDogKCkgPT4gdm9pZCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3N0b3BNZXRob2RzW2tleV0gPSBtZXRob2Q7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldFNldHRpbmdzKHM6IFRTZXR0aW5ncyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5faGFzU3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gcztcclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgICAgICB0aGlzLm9uUmVhZHkoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBPYnNvbGV0ZTogZG8gbm90IHVzZSEgVG8gYmUgcmVtb3ZlZCFcclxuICAgIHB1YmxpYyBzKGtleToga2V5b2YgVFNldHRpbmdzLCBiYWNrdXA/KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U2V0dGluZyhrZXksIGJhY2t1cCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFNldHRpbmdzKCk6IFRTZXR0aW5ncyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEludGVyZmFjZSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgIHB1YmxpYyBzaG93TXlQYWdlKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0SW50ZXJmYWNlKCkucmVxdWVzdFNob3dNeVBhZ2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0U3lzdGVtU2V0dGluZ3MoKTogV2lkZ2V0UnVudGltZU9wdGlvbnMge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zeXN0ZW1TZXR0aW5ncztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0SW50ZXJmYWNlKCk6IFdpZGdldEFwaSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N5c3RlbVNldHRpbmdzLnBsYXlQcm94eTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0RW52aXJvbm1lbnQoKTogRW52aXJvbm1lbnQge1xyXG4gICAgICAgIHJldHVybiAodGhpcy5fc3lzdGVtU2V0dGluZ3MubW9kZSB8fCAncGxheWVyX2xpdmUnKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0Q3VycmVudFBhZ2VJZCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEludGVyZmFjZSgpLmdldEN1cnJlbnRQYWdlSWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW5BZG1pbigpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRFbnZpcm9ubWVudCgpID09PSAnYWRtaW4nO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpblRlc3RpbmcoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RW52aXJvbm1lbnQoKSA9PT0gJ3BsYXllcl90ZXN0aW5nJztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW5MaXZlKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEVudmlyb25tZW50KCkgPT09ICdwbGF5ZXJfbGl2ZSc7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHZhbGlkYXRlKG9wdGlvbnM/OiBTdWJtaXNzaW9uT3B0aW9ucyk6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIHN1Y2Nlc3MsIGVycm9yLCBjdXJyZW50V2lkZ2V0T25seTp0cnVlLCBjdXJyZW50UGFnZU9ubHlcclxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuXHJcbiAgICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KCdjdXJyZW50UGFnZScpICYmXHJcbiAgICAgICAgICAgICFvcHRpb25zLmhhc093blByb3BlcnR5KCdjdXJyZW50U2VjdGlvbicpICYmXHJcbiAgICAgICAgICAgICFvcHRpb25zLmhhc093blByb3BlcnR5KCdjdXJyZW50V2lkZ2V0T25seScpKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuY3VycmVudFdpZGdldE9ubHkgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SW50ZXJmYWNlKCkudmFsaWRhdGUob3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN1Ym1pdChvcHRpb25zPzogU3VibWlzc2lvbk9wdGlvbnMpOiBib29sZWFuIHtcclxuICAgICAgICAvLyBzdWNjZXNzLCBlcnJvciwgY3VycmVudFdpZGdldE9ubHk6dHJ1ZSwgY3VycmVudFBhZ2VPbmx5XHJcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcbiAgICAgICAgaWYgKCFvcHRpb25zLmhhc093blByb3BlcnR5KCdjdXJyZW50UGFnZScpICYmXHJcbiAgICAgICAgICAgICFvcHRpb25zLmhhc093blByb3BlcnR5KCdjdXJyZW50U2VjdGlvbicpICYmXHJcbiAgICAgICAgICAgICFvcHRpb25zLmhhc093blByb3BlcnR5KCdjdXJyZW50V2lkZ2V0T25seScpKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuY3VycmVudFdpZGdldE9ubHkgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnRlcmZhY2UoKS5zdWJtaXQob3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN1Ym1pdEFzeW5jKGRhdGE/OiBQbGF5ZXJTdWJtaXNzaW9uRGF0YSwgY3VycmVudFBhZ2U/OiBib29sZWFuLCBjdXJyZW50U2VjdGlvbj86IGJvb2xlYW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFdpZGdldE9ubHk/OiBib29sZWFuLCBuZXh0UGFnZUlkPzogc3RyaW5nLCBwcm9ncmVzcz86IFByb2dyZXNzTGlzdGVuZXIpXHJcbiAgICAgICAgOiBQcm9taXNlPFN1Ym1pc3Npb25SZXN1bHQ+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRQYWdlICYmICFjdXJyZW50U2VjdGlvbiAmJiAhY3VycmVudFdpZGdldE9ubHkpIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRXaWRnZXRPbmx5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS5zdWJtaXQoe1xyXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRQYWdlOiBjdXJyZW50UGFnZSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRTZWN0aW9uOiBjdXJyZW50U2VjdGlvbixcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRXaWRnZXRPbmx5OiBjdXJyZW50V2lkZ2V0T25seSxcclxuICAgICAgICAgICAgICAgIG5leHRQYWdlSWQ6IG5leHRQYWdlSWQsXHJcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogcHJvZ3Jlc3MsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBzdWJtaXNzaW9uUmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Ym1pc3Npb25SZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBzdWJtaXNzaW9uUmVzdWx0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3Qoc3VibWlzc2lvblJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnb1RvTGluayhocmVmOiBzdHJpbmcsIG5ld1RhYjogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIGhyZWYgPSBocmVmIHx8ICh0aGlzLl9zZXR0aW5ncyBhcyBhbnkpLmhyZWY7XHJcbiAgICAgICAgaWYgKG5ld1RhYiA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBocmVmO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5vcGVuKGhyZWYsICdfYmxhbmsnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdvVG9QYWdlKHBhZ2VJZD86IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHBhZ2VJZCA9IHBhZ2VJZCB8fCB0aGlzLmdldFNldHRpbmcoJ25leHRQYWdlSWQnKTtcclxuICAgICAgICB0aGlzLmdldEludGVyZmFjZSgpLnNob3dQYWdlKHBhZ2VJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFByb21vdGlvbklkKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKS5wcm9tb3Rpb24uaWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFByb21vdGlvblNob3J0SWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRTeXN0ZW1TZXR0aW5ncygpLnByb21vdGlvbi5zaG9ydElkO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRTZXNzaW9uSWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRTeXN0ZW1TZXR0aW5ncygpLnNlc3Npb25JZDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0V2lkZ2V0SG9sZGVySWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRXaWRnZXRJZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRXaWRnZXRJZCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFN5c3RlbVNldHRpbmdzKCkud2lkZ2V0SWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFdpZGdldE5hbWUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFdpZGdldFZlcnNpb24oKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdmVyc2lvbjtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0U2VydmVyRGF0ZVRpbWUoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnRlcmZhY2UoKS5nZXRUaW1lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFByb21vdGlvblN0YXJ0RGF0ZVRpbWUoKTogRGF0ZVRpbWVPZmZzZXQge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFN5c3RlbVNldHRpbmdzKCkucHJvbW90aW9uLnN0YXJ0RGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0UHJvbW90aW9uQ2xvc2VEYXRlVGltZSgpOiBEYXRlVGltZU9mZnNldCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKS5wcm9tb3Rpb24uY2xvc2VEYXRlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRBY3RpdmVTdGF0ZVZhbHVlSWQoc3RhdGVJZDogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnRlcmZhY2UoKS5nZXRBY3RpdmVTdGF0ZVZhbHVlSWQoc3RhdGVJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNoYW5nZVN0YXRlVmFsdWUoc3RhdGVJZD86IHN0cmluZywgc3RhdGVWYWx1ZUlkPzogc3RyaW5nKSB7XHJcbiAgICAgICAgc3RhdGVJZCA9IHN0YXRlSWQgfHwgKHRoaXMucygnc2V0U3RhdGVJZCcpIGFzIHVua25vd24gYXMgc3RyaW5nKTtcclxuICAgICAgICBpZiAoIXN0YXRlSWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3RhdGVWYWx1ZUlkID0gc3RhdGVWYWx1ZUlkIHx8ICh0aGlzLnMoJ3NldFN0YXRlVmFsdWVJZCcpIGFzIHVua25vd24gYXMgc3RyaW5nKSB8fCBudWxsO1xyXG4gICAgICAgIC8vIGlmICghc3RhdGVWYWx1ZUlkKSByZXR1cm47XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLnNldEFjdGl2ZVN0YXRlVmFsdWVJZChzdGF0ZUlkLCBzdGF0ZVZhbHVlSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXRBY3RpdmVTdGF0ZVZhbHVlSWQoc3RhdGVJZDogc3RyaW5nLCBzdGF0ZVZhbHVlSWQ6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEludGVyZmFjZSgpLnNldEFjdGl2ZVN0YXRlVmFsdWVJZChzdGF0ZUlkLCBzdGF0ZVZhbHVlSWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRXaWRnZXRSb290VXJsKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKS51cmxzLndpZGdldDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0QVBJVXJsKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKS51cmxzLmFwaTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0UmVzb3VyY2VVcmwoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRTeXN0ZW1TZXR0aW5ncygpLnVybHMucmVzb3VyY2VzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRTZXJ2aWNlVXJsKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKS51cmxzLnNlcnZpY2VzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpc0Nvbm5lY3RlZFRvTmV0d29yayhvcHRpb25zOiBTb2NpYWxDb25uZWN0T3B0aW9ucyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0SW50ZXJmYWNlKCkuaXNDb25uZWN0ZWRUb05ldHdvcmsob3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gV2lkZ2V0IENvbW11bmljYXRpb24gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgcHVibGljIGdldFNoYXJlZFZhbHVlU3RvcmUoKTogU2hhcmVkVmFsdWVTdG9yZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKS5zaGFyZWRWYWx1ZVN0b3JlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhc3NpZ25TaGFyZWRWYWx1ZShrZXk6IHN0cmluZywgZGF0YTogYW55KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCFrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBzaGFyZWRWYWx1ZVN0b3JlID0gdGhpcy5nZXRTaGFyZWRWYWx1ZVN0b3JlKCk7XHJcbiAgICAgICAgc2hhcmVkVmFsdWVTdG9yZS5zZXQoa2V5LCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0U2hhcmVkVmFsdWUoa2V5OiBzdHJpbmcpOiBhbnkge1xyXG4gICAgICAgIGlmICgha2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3Qgc2hhcmVkVmFsdWVTdG9yZSA9IHRoaXMuZ2V0U2hhcmVkVmFsdWVTdG9yZSgpO1xyXG4gICAgICAgIHJldHVybiBzaGFyZWRWYWx1ZVN0b3JlLmdldChrZXkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRTYXZlZFByb2dyZXNzKCk6IGFueSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZ2V0SW50ZXJmYWNlKCkuZ2V0U2F2ZWRQcm9ncmVzcykge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnRlcmZhY2UoKS5nZXRTYXZlZFByb2dyZXNzKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFNhdmVkUHJvZ3Jlc3NWYWx1ZShrZXk6IHN0cmluZyk6IGFueSB7XHJcbiAgICAgICAgY29uc3Qgc2F2ZWREYXRhID0gdGhpcy5nZXRTYXZlZFByb2dyZXNzKCk7XHJcbiAgICAgICAgaWYgKHNhdmVkRGF0YSAmJiBzYXZlZERhdGEuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2F2ZWREYXRhW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvblNhdmVkUHJvZ3Jlc3NVcGRhdGVkKCk6IHZvaWQge1xyXG4gICAgICAgIC8vIE92ZXJyaWRlIG1lXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNhdmVQcm9ncmVzcyhrZXk6IHN0cmluZywgZGF0YTogYW55KTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCFrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZ2V0SW50ZXJmYWNlKCkuaGFzT3duUHJvcGVydHkoJ2dldFNhdmVkUHJvZ3Jlc3MnKSkge1xyXG4gICAgICAgICAgICAvLyB0aGlzLmdldEludGVyZmFjZSgpLmdldFNhdmVkUHJvZ3Jlc3MoKVtrZXldID0gdmFsdWU7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnN1Ym1pdCh7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50V2lkZ2V0T25seTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBrZXk6IGtleSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcmVMb2NhbFN0b3JhZ2Uoa2V5LCBkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0b3JlUHJvbW90aW9uRGF0YShrZXk6IHN0cmluZywgZGF0YSkge1xyXG4gICAgICAgIHRoaXMuc3RvcmVMb2NhbFN0b3JhZ2UodGhpcy5nZXRQcm9tb3Rpb25JZCgpICsgJ18nICsga2V5LCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0UHJvbW90aW9uRGF0YShrZXk6IHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldExvY2FsU3RvcmFnZSh0aGlzLmdldFByb21vdGlvbklkKCkgKyAnXycgKyBrZXkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFV0aWxpdHkgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgIHB1YmxpYyB2aXNpYmxlKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pc1Zpc2libGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGxvZyhtZXNzYWdlLCBlPyk6IHZvaWQge1xyXG4gICAgICAgIGlmICghdGhpcy5pbkxpdmUoKSkge1xyXG4gICAgICAgICAgICB0aGlzLmdldEludGVyZmFjZSgpLmxvZyhtZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGZpbmRDdXJseUtleXMoc3RyaW5nOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgZm91bmQgPSBbXTtcclxuICAgICAgICBjb25zdCByeHAgPSAveyhbXn1dKyl9L2c7XHJcbiAgICAgICAgbGV0IGN1ck1hdGNoO1xyXG4gICAgICAgIHdoaWxlIChjdXJNYXRjaCA9IHJ4cC5leGVjKHN0cmluZykpIHtcclxuICAgICAgICAgICAgZm91bmQucHVzaChjdXJNYXRjaFsxXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmb3VuZDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0UHJvbW90aW9uU2hhcmluZ1VSTCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFN5c3RlbVNldHRpbmdzKCkucHJvbW90aW9uLnNoYXJlVXJsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRQcm9tb3Rpb25TaGFyaW5nVVJMRGlyZWN0KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3lzdGVtU2V0dGluZ3MoKS5wcm9tb3Rpb24uc2hhcmVVcmxEaXJlY3Q7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFRlc3RpbmdTdGF0ZXMoKTogdGhpcyB7XHJcbiAgICAgICAgLy8gVXNlZCBmb3Igd2lkZ2V0IHRlc3RpbmdcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RvcmVMb2NhbFN0b3JhZ2Uoa2V5OiBzdHJpbmcsIGRhdGE6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHN0b3JhZ2VNZXRob2QgPSBsb2NhbFN0b3JhZ2U7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHN0b3JhZ2VNZXRob2QgJiYga2V5ICYmIGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHN0b3JhZ2VNZXRob2Rba2V5XSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0gY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldExvY2FsU3RvcmFnZShrZXk6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3Qgc3RvcmFnZU1ldGhvZCA9IGxvY2FsU3RvcmFnZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAoc3RvcmFnZU1ldGhvZCAmJiBrZXkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdG9yYWdlTWV0aG9kW2tleV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSBjYXRjaCAoZXgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBiaW5kKGtleTogc3RyaW5nLCBjYWxsYmFjazogKCkgPT4gdm9pZCwgaWQ/OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAga2V5ID0ga2V5LnJlcGxhY2UoJy4nLCAnXycpO1xyXG4gICAgICAgIGlmIChpZCkge1xyXG4gICAgICAgICAgICBjb25zdCB0aGF0ID0gdGhpcztcclxuICAgICAgICAgICAgdGhhdC5fZXZlbnRzW2lkXSA9IHRydWU7XHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5vbihrZXksIGZ1bmN0aW9uKCk6IHZvaWQge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoYXQuX2V2ZW50c1tpZF0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5vbihrZXksIGNhbGxiYWNrKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uKGtleTogc3RyaW5nLCBjYWxsYmFjayk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuYmluZChrZXksIGNhbGxiYWNrKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdW5iaW5kKGlkOiBzdHJpbmcpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIWlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZXZlbnRzW2lkXSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB0cmlnZ2VyKGtleTogc3RyaW5nLCBkYXRhKTogdm9pZCB7XHJcbiAgICAgICAgLy8gRGF0YSBzaG91bGQgYmUgYW4gYXJyYXlcclxuICAgICAgICBrZXkgPSBrZXkucmVwbGFjZSgnLicsICdfJyk7XHJcbiAgICAgICAgJCgnYm9keScpLnRyaWdnZXIoa2V5LCBkYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW50ZXJmYWNlQWRkRXZlbnRMaXN0ZW5lcihldmVudElkOiBzdHJpbmcsIGxpc3RlbmVySWQ6IHN0cmluZywgY2FsbGJhY2spOiB2b2lkIHtcclxuICAgICAgICAvLyBUT0RPIEFkZCBlbnVtIGZvciBzeXN0ZW0gZXZlbnRzXHJcbiAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS5hZGRFdmVudExpc3RlbmVyKGV2ZW50SWQsIGxpc3RlbmVySWQsIGNhbGxiYWNrKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW50ZXJmYWNlUmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudElkOiBzdHJpbmcsIGxpc3RlbmVySWQ6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0SW50ZXJmYWNlKCkucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudElkLCBsaXN0ZW5lcklkKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaW50ZXJmYWNlRmlyZUV2ZW50KGV2ZW50SWQ6IHN0cmluZywgZGF0YTogYW55KTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS5maXJlRXZlbnQoZXZlbnRJZCwgZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFByb3hpZWRVcmwodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICh1cmwuaW5kZXhPZignaHR0cCcpICE9PSAwKSB7XHJcbiAgICAgICAgICAgIGxldCBwcm90b2NvbCA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbDtcclxuXHJcbiAgICAgICAgICAgIGlmIChwcm90b2NvbCA9PT0gJ2Fib3V0OicpIHtcclxuICAgICAgICAgICAgICAgIHByb3RvY29sID0gJ2h0dHA6JzsgLy8gVGhpcyBtYXkgYmUganVzdCBhcyBpbnZhbGlkLCBvZiBjb3Vyc2VcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdXJsID0gcHJvdG9jb2wgKyB1cmw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRTeXN0ZW1TZXR0aW5ncygpLnVybHMucHJveHkgKyAnP3VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHVybCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGxvYWRTY3JpcHQoc2NyaXB0VXJsOiBzdHJpbmcsIGNhbGxiYWNrKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS5sb2FkU2NyaXB0KHNjcmlwdFVybCwgY2FsbGJhY2spO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhc3luYyBsb2FkU2NyaXB0QXN5bmMoc2NyaXB0VXJsOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJmYWNlKCkubG9hZFNjcmlwdChzY3JpcHRVcmwsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGxvYWRTdHlsZShzdHlsZVVybDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS5sb2FkU3R5bGUoc3R5bGVVcmwpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpc01vYmlsZSgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gL0FuZHJvaWQvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpIHx8IC9pUGhvbmV8aVBhZHxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGVib3VuY2UoZnVuYywgd2FpdDogbnVtYmVyLCBpbW1lZGlhdGU/OiBib29sZWFuKSB7XHJcbiAgICAgICAgbGV0IHRpbWVvdXQ7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCk6IHZvaWQge1xyXG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcztcclxuICAgICAgICAgICAgY29uc3QgYXJncyA9IGFyZ3VtZW50cztcclxuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xyXG4gICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIGlmICghaW1tZWRpYXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgd2FpdCk7XHJcbiAgICAgICAgICAgIGlmIChpbW1lZGlhdGUgJiYgIXRpbWVvdXQpIHtcclxuICAgICAgICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFuYWx5dGljcyAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgIHB1YmxpYyB0cmFjayhldmVudElkOiBUcmFja0V2ZW50RXZlbnRJZCxcclxuICAgICAgICAgICAgICAgICBldmVudERhdGE/OiBUcmFja0V2ZW50RGF0YSB8IHN0cmluZyB8IFNlbWFudGljRmllbGRJdGVtU2V0dGluZ3NbXVtdIHwgUXVlc3Rpb25EYXRhKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS50cmFja0V2ZW50KGV2ZW50SWQsIGV2ZW50RGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldENvb2tpZUNvbnNlbnRBY2tub3dsZWRnZWQoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS5zZXRDb29raWVDb25zZW50QWNrbm93bGVkZ2VkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldENvb2tpZUNvbnNlbnRBY2NlcHRlZCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmdldEludGVyZmFjZSgpLnNldENvb2tpZUNvbnNlbnRBY2NlcHRlZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcGVuQ29va2llQ29uc2VudFNldHRpbmdzKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZ2V0SW50ZXJmYWNlKCkub3BlbkNvb2tpZUNvbnNlbnRTZXR0aW5ncygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJvb3QgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgIHB1YmxpYyBmKHF1ZXJ5OiBzdHJpbmcpOiBKUXVlcnkge1xyXG4gICAgICAgIGlmIChxdWVyeSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRSb290KCkuZmluZChxdWVyeSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9yb290RWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFJvb3QoKTogSlF1ZXJ5IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcm9vdEVsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGFzc2lmeShzdHI6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHN0ci50cmltKCkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgJ18nKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZmluZE5lc3RlZFZhbHVlKG9iaiwgbmVzdGVkS2V5OiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAoIW9iaiB8fCAhbmVzdGVkS2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdG9rZW5zID0gbmVzdGVkS2V5LnNwbGl0KCcuJyk7XHJcbiAgICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiB0b2tlbnMpIHtcclxuICAgICAgICAgICAgb2JqID0gb2JqW3Rva2VuXTtcclxuICAgICAgICAgICAgaWYgKG9iaiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVwbGFjZUR5bmFtaWNWYXJpYWJsZXMoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgICAgIC8vIFJlcGxhY2Uge3Njb3JlfSB3aXRoIGFjdHVhbCBzY29yZSAoNTApXHJcblxyXG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xyXG5cclxuICAgICAgICBpZiAoc3RyICYmIHR5cGVvZiAoc3RyKSA9PT0gJ3N0cmluZycgJiYgc3RyLmluZGV4T2YoJ3snKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvdW5kID0gdGhpcy5maW5kQ3VybHlLZXlzKHN0cik7XHJcbiAgICAgICAgICAgIGZvdW5kLmZvckVhY2goKHZhclJlcGxhY2U6IHN0cmluZyk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gdGhhdC5nZXRTaGFyZWRWYWx1ZSh2YXJSZXBsYWNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoIXZhbHVlICYmIHZhbHVlICE9PSBmYWxzZSAmJiB2YWx1ZSAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YXJSZXBsYWNlID09PSAndGVybXMnIHx8IHZhclJlcGxhY2UgPT09ICdwcml2YWN5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoYXQuaW5BZG1pbigpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCh2YXJSZXBsYWNlLmluZGV4T2YoJ3Njb3JlJykgPiAtMSkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgKHZhclJlcGxhY2UuaW5kZXhPZigndG90YWwnKSA9PT0gMCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAnMDAwJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YXJSZXBsYWNlLmluZGV4T2YoJ3RpbWUnKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9ICcwMDowMCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKCd7JyArIHZhclJlcGxhY2UgKyAnfScsIHZhbHVlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gc3RyO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjbGVhbkhUTUwoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5nZXRSb290KCkuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgbGV0IG5ld0hUTUwgPSB0aGlzLmdldEhUTUwoKTtcclxuICAgICAgICBpZiAobmV3SFRNTCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2RvbnRSZXBsYWNlSFRNTCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdFJlcGxhY2VIVE1MID0gbmV3SFRNTDtcclxuICAgICAgICAgICAgICAgIG5ld0hUTUwgPSB0aGlzLnJlcGxhY2VEeW5hbWljVmFyaWFibGVzKG5ld0hUTUwgYXMgdW5rbm93biBhcyBzdHJpbmcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0Um9vdCgpLmFwcGVuZChuZXdIVE1MIGFzIEpRdWVyeSB8IHN0cmluZyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9yZW5kZXJlZCA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldEhUTUwoKTogSlF1ZXJ5IHwgc3RyaW5nIHwgUHJvbWlzZTxKUXVlcnk+IHtcclxuICAgICAgICAvLyBPdmVycmlkZSBtZVxyXG4gICAgICAgIHJldHVybiAkKCcnKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVmcmVzaCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNsZWFuSFRNTCgpO1xyXG5cclxuICAgICAgICBmb3IgKGNvbnN0IG1ldGhvZCBvZiB0aGlzLl9zZXR1cE1ldGhvZHMpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2V0dXBNZXRob2RzW21ldGhvZF0uY2FsbCh0aGlzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMub25TZXR1cCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzaW11bGF0ZSgpOiB2b2lkIHtcclxuICAgICAgICAvLyBPdmVycmlkZSBtZVxyXG4gICAgfVxyXG5cclxuICAgIC8vIERhdGEgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgIHB1YmxpYyB2YWxpZGF0ZVN1Ym1pc3Npb25EYXRhKCk6IFN1Ym1pc3Npb25EYXRhVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgICAgICAgLy8gT3ZlcnJpZGVcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2YWxpZDogdHJ1ZSxcclxuICAgICAgICAgICAgZXJyb3JzOiBbXVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFN1Ym1pc3Npb25EYXRhKCk6IFBsYXllclN1Ym1pc3Npb25EYXRhIHtcclxuICAgICAgICAvLyBPdmVycmlkZVxyXG4gICAgICAgIHJldHVybiB2b2lkIDA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRnVuY3Rpb25hbGl0eSAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gICAgcHVibGljIGluaXQoKTogdm9pZCB7XHJcbiAgICAgICAgLy8gT3ZlcnJpZGUgbWVcclxuICAgICAgICAvLyBQUkUtU0VUVElORyBTVEFURVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvblJlYWR5KCk6IHZvaWQge1xyXG4gICAgICAgIC8vIE92ZXJyaWRlIG1lXHJcbiAgICAgICAgLy8gSEFTIFNFVFRJTkdTLCBOT1QgUkVOREVSRURcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb25TZXR1cCgpOiB2b2lkIHtcclxuICAgICAgICAvLyBPdmVycmlkZSBtZVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGFydCgpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3JlbmRlcmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGNvbnN0IG1ldGhvZCBvZiB0aGlzLl9zdGFydE1ldGhvZHMpIHtcclxuICAgICAgICAgICAgdGhpcy5fc3RhcnRNZXRob2RzW21ldGhvZF0uY2FsbCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vblNob3coKTtcclxuICAgICAgICB0aGlzLl9pc1Zpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2hhc1N0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdG9wKCk6IHZvaWQge1xyXG4gICAgICAgIGZvciAoY29uc3QgbWV0aG9kIG9mIHRoaXMuX3N0b3BNZXRob2RzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0b3BNZXRob2RzW21ldGhvZF0uY2FsbCh0aGlzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMub25IaWRlKCk7XHJcbiAgICAgICAgdGhpcy5faXNWaXNpYmxlID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uRWRpdG9yQWRkZWQoZXZlbnQ6IFdpZGdldERlc2lnbmVyRXZlbnQ8YW55Pik6IHZvaWQge1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvbkVkaXRvclJlZnJlc2goZXZlbnQ6IFdpZGdldERlc2lnbmVyRXZlbnQ8YW55Pik6IHZvaWQge1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvblNob3coKTogdm9pZCB7XHJcbiAgICAgICAgLy8gT3ZlcnJpZGUgbWVcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb25IaWRlKCk6IHZvaWQge1xyXG4gICAgICAgIC8vIE92ZXJyaWRlIG1lXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHVwZGF0ZSgpOiB2b2lkIHtcclxuICAgICAgICAvLyBBZGQgYW4gLm9uVXBkYXRlIG1ldGhvZCBpbiB3aWRnZXRcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZmluZChxdWVyeTogc3RyaW5nKTogSlF1ZXJ5IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mKHF1ZXJ5KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0U2V0dGluZzxUIGV4dGVuZHMga2V5b2YgVFNldHRpbmdzPihrZXk6IFQsIGJhY2t1cD86IFRTZXR0aW5nc1tUXSk6IFRTZXR0aW5nc1tUXSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9zZXR0aW5ncykge1xyXG4gICAgICAgICAgICByZXR1cm4gYmFja3VwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgdGhlU2V0dGluZyA9IHRoaXMuX3NldHRpbmdzW2tleV07XHJcblxyXG4gICAgICAgIGlmICh0aGVTZXR0aW5nID09PSBudWxsIHx8IHRoZVNldHRpbmcgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYmFja3VwO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhlU2V0dGluZztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0U2hhcmVkU2V0dGluZzxUIGV4dGVuZHMga2V5b2YgVFNldHRpbmdzPihcclxuICAgICAgICBrZXk6IFQsXHJcbiAgICAgICAgc2V0dGluZ3NXaWRnZXRJZDogc3RyaW5nLFxyXG4gICAgICAgIGJhY2t1cD86IFRTZXR0aW5nc1tUXSk6IFRTZXR0aW5nc1tUXSB7XHJcblxyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdGhpcy5nZXRTZXR0aW5nc0ZvcldpZGdldChzZXR0aW5nc1dpZGdldElkKTtcclxuICAgICAgICBpZiAoc2V0dGluZ3MgPT09IG51bGwgfHwgc2V0dGluZ3MgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTZXR0aW5nKGtleSwgYmFja3VwKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHRoZVNldHRpbmcgPSBzZXR0aW5nc1trZXldO1xyXG4gICAgICAgIGlmICh0aGVTZXR0aW5nID09PSBudWxsIHx8IHRoZVNldHRpbmcgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYmFja3VwO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhlU2V0dGluZztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0UmVxdWlyZWROZXR3b3JrU2NvcGVzKG5ldHdvcms6IE5ldHdvcmspOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRSZXF1aXJlZE5ldHdvcmtzKCk6IE5ldHdvcmtbXSB7XHJcbiAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpc1N0YXJ0ZWQoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldFNoYXJlYWJsZVZhcmlhYmxlS2V5cyhrZXlzOiBzdHJpbmdbXSk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGtleSA9ICdzaGFyZWFibGVrZXlzXycgKyB0aGlzLmdldFdpZGdldE5hbWUoKTtcclxuICAgICAgICB0aGlzLmdldFNoYXJlZFZhbHVlU3RvcmUoKS5zZXQoa2V5LCBrZXlzKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0V2lkZ2V0KHdpZGdldElkOiBzdHJpbmcpOiBXaWRnZXRWMjxUU2V0dGluZ3M+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnRlcmZhY2UoKS5nZXRXaWRnZXQod2lkZ2V0SWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRTZXR0aW5nc0ZvcldpZGdldCh3aWRnZXRJZDogc3RyaW5nKTogVFNldHRpbmdzIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRJbnRlcmZhY2UoKS5nZXRTZXR0aW5nc0ZvcldpZGdldCh3aWRnZXRJZCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGlzQ29ubmVjdGVkVG9OZXR3b3JrQXN5bmMobmV0d29yazogTmV0d29yayxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pc3Npb25EYXRhPzogUGxheWVyU3VibWlzc2lvbkRhdGEpOiBQcm9taXNlPE5ldHdvcmtDcmVkZW50aWFscz4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJmYWNlKCkuaXNDb25uZWN0ZWRUb05ldHdvcmsoe1xyXG4gICAgICAgICAgICAgICAgbmV0d29yazogbmV0d29yayxcclxuICAgICAgICAgICAgICAgIHN1Ym1pc3Npb25EYXRhOiBzdWJtaXNzaW9uRGF0YSxcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGNyZWRlbnRpYWxzID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYWNrKCdhbHJlYWR5X2Nvbm5lY3RlZCcsIHsgbmV0d29yazogbmV0d29yayB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNyZWRlbnRpYWxzKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBlcnJvcjogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY29ubmVjdFRvTmV0d29ya0FzeW5jKG5ldHdvcms6IE5ldHdvcmssIHN1Ym1pc3Npb25EYXRhPzogUGxheWVyU3VibWlzc2lvbkRhdGEpOiBQcm9taXNlPE5ldHdvcmtDcmVkZW50aWFscz4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMudHJhY2soJ2Nvbm5lY3QnLCBuZXR3b3JrKTtcclxuICAgICAgICAgICAgdGhpcy5nZXRJbnRlcmZhY2UoKS5jb25uZWN0VG9OZXR3b3JrKHtcclxuICAgICAgICAgICAgICAgIG5ldHdvcms6IG5ldHdvcmssXHJcbiAgICAgICAgICAgICAgICBzdWJtaXNzaW9uRGF0YTogc3VibWlzc2lvbkRhdGEsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBjcmVkZW50aWFscyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50cmFjaygnY29ubmVjdGVkJywgbmV0d29yayk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjcmVkZW50aWFscyk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlZnJlc2hUb2tlbkFzeW5jKG5ldHdvcms6IE5ldHdvcmssIHN1Ym1pc3Npb25EYXRhPzogUGxheWVyU3VibWlzc2lvbkRhdGEpOiBQcm9taXNlPE5ldHdvcmtDcmVkZW50aWFscz4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0SW50ZXJmYWNlKCkucmVmcmVzaFRva2VuKHtcclxuICAgICAgICAgICAgICAgIG5ldHdvcms6IG5ldHdvcmssXHJcbiAgICAgICAgICAgICAgICBzdWJtaXNzaW9uRGF0YTogc3VibWlzc2lvbkRhdGEsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBjcmVkZW50aWFscyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjcmVkZW50aWFscyk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGlzSW5BcHBCcm93c2VyUmVkaXJlY3QoKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIChsb2NhdGlvbi5zZWFyY2guaW5kZXhPZignY2NfY29ubmVjdD0nKSAhPT0gLTEpXHJcbiAgICAgICAgICAgIHx8IChkb2N1bWVudC5yZWZlcnJlciA9PT0gJ2h0dHBzOi8vYXV0aG9yaXplLm11c2ljLmFwcGxlLmNvbS9sb2FkaW5nJyk7XHJcbiAgICB9XHJcbn1cclxuXHJcblNvY2lhbFByb21vdGUuV2lkZ2V0cy5jb3JlVjIgPSBXaWRnZXQ7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWtCQTtBQUtBO0FBZUE7QUFDQTtBQUNBO0FBQ0E7QUFYQTtBQUNBO0FBQ0E7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBOzs7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFKQTs7Ozs7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBOXdCQTtBQWd4QkE7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/core/basewidget/v2/widget.ts\n");

/***/ }),

/***/ "./src/core/registration/widget-shim.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar WidgetShim = /** @class */ (function () {\r\n    function WidgetShim(coreVersion) {\r\n        if (coreVersion === void 0) { coreVersion = 2; }\r\n        this.coreVersion = coreVersion;\r\n    }\r\n    WidgetShim.prototype.DeriveFrom = function () {\r\n        function FakeBase() { }\r\n        var baseWidget = SocialPromote.Widgets['coreV' + this.coreVersion];\r\n        if (!baseWidget) {\r\n            throw new Error(\"Base widget version \" + this.coreVersion + \" not found.\");\r\n        }\r\n        FakeBase.prototype = baseWidget.prototype;\r\n        FakeBase.prototype.constructor = FakeBase;\r\n        return FakeBase;\r\n    };\r\n    /**\r\n     * Registers the widget within the widget factory.\r\n     * @param widgetId The unique identifier of the widget\r\n     * @param version The version number of the widget\r\n     * @param widget The widget constructor\r\n     */\r\n    WidgetShim.prototype.register = function (widgetId, version, widget) {\r\n        return this.registerWithModules(widgetId, version, [], widget);\r\n    };\r\n    /**\r\n     * Registers the widget within the widget factory.\r\n     * This registration function is for legacy support. We should be moving away from references modules the old way (passing in a\r\n     * string array of module names and having the player/manager load them at runtime)\r\n     * @param widgetId The unique identifier of the widget\r\n     * @param version The version number of the widget\r\n     * @param moduleRefs A string array containing the names/versions of modules to be monkey patched onto the widget instance.\r\n     * @param widget The widget constructor\r\n     */\r\n    WidgetShim.prototype.registerWithModules = function (widgetId, version, moduleRefs, widget) {\r\n        if (widget.name === 'FakeBase') {\r\n            console.log('Cannot register a widget instance using the abstract base class. Register a derived widget instead.');\r\n            throw new Error('Cannot register a widget instance using the abstract base class. Register a derived widget instead.');\r\n        }\r\n        // Pass in a dummy object as the widget to avoid the SocialPromote monkey patching. It was a crap way of doing it anyway.\r\n        SocialPromote.registerWidget(widgetId, version, this.coreVersion, moduleRefs, {});\r\n        var key = widgetId + (version ? ':' + version : '');\r\n        var factory = SocialPromote.Widgets[key];\r\n        // We need to extend the factory method here to support proper inheritance (for TypeScript classes that use it), but we also need\r\n        // to replace the FakeBase base class, if present, with the actual monkey patched runtime widget instance.\r\n        SocialPromote.Widgets[key] = function (widgetData) {\r\n            var temp = widget;\r\n            do {\r\n                if (temp.__proto__.name === 'FakeBase') {\r\n                    temp.prototype = new factory(widgetData);\r\n                }\r\n                temp = temp.prototype;\r\n            } while (temp.prototype != null);\r\n            temp.prototype = new factory(widgetData);\r\n            return new widget(widgetId, version, widgetData);\r\n        };\r\n        this.bindProperties(widget, factory);\r\n        return factory;\r\n    };\r\n    /**\r\n     * Registers the widget within the widget factory.\r\n     * @param widgetId The unique identifier of the widget\r\n     * @param version The version number of the widget\r\n     * @param widget The widget class\r\n     */\r\n    WidgetShim.prototype.registerSimple = function (widgetId, version, widget) {\r\n        var key = widgetId + (version ? ':' + version : '');\r\n        SocialPromote.Widgets[key] = widget;\r\n    };\r\n    WidgetShim.prototype.bindProperties = function (widget, factory) {\r\n        for (var propertyKey in widget.prototype) {\r\n            if (widget.prototype.hasOwnProperty(propertyKey)) {\r\n                var descriptor = Object.getOwnPropertyDescriptor(widget.prototype, propertyKey);\r\n                if (descriptor.get != null) {\r\n                    // This is a property (as opposed to a field) so we need to restore it. The SocialPromote registerWidget function\r\n                    // effectively freezes properties at the time of it's invocation, by copying the property value to the prototype\r\n                    // (instead of redefining the property using the getter).\r\n                    // Here we redefine the property using the property descriptor.\r\n                    delete factory.prototype[propertyKey];\r\n                    Object.defineProperty(factory.prototype, propertyKey, descriptor);\r\n                }\r\n                else {\r\n                    factory.prototype[propertyKey] =\r\n                        widget.prototype[propertyKey];\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return WidgetShim;\r\n}());\r\nexports.WidgetShim = WidgetShim;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29yZS9yZWdpc3RyYXRpb24vd2lkZ2V0LXNoaW0udHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvY29yZS9yZWdpc3RyYXRpb24vd2lkZ2V0LXNoaW0udHM/ODllOSJdLCJzb3VyY2VzQ29udGVudCI6WyJkZWNsYXJlIHZhciBTb2NpYWxQcm9tb3RlO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdpZGdldFNoaW0ge1xyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjb3JlVmVyc2lvbjogbnVtYmVyID0gMikge31cclxuXHJcbiAgICBwdWJsaWMgRGVyaXZlRnJvbTxUPigpOiBuZXcgKCkgPT4gVCB7XHJcbiAgICAgICAgZnVuY3Rpb24gRmFrZUJhc2UoKSB7fVxyXG5cclxuICAgICAgICBjb25zdCBiYXNlV2lkZ2V0ID0gU29jaWFsUHJvbW90ZS5XaWRnZXRzWydjb3JlVicgKyB0aGlzLmNvcmVWZXJzaW9uXTtcclxuICAgICAgICBpZiAoIWJhc2VXaWRnZXQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxyXG4gICAgICAgICAgICAgICAgYEJhc2Ugd2lkZ2V0IHZlcnNpb24gJHt0aGlzLmNvcmVWZXJzaW9ufSBub3QgZm91bmQuYFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgRmFrZUJhc2UucHJvdG90eXBlID0gYmFzZVdpZGdldC5wcm90b3R5cGU7XHJcbiAgICAgICAgRmFrZUJhc2UucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRmFrZUJhc2U7XHJcbiAgICAgICAgcmV0dXJuIEZha2VCYXNlIGFzIGFueTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlZ2lzdGVycyB0aGUgd2lkZ2V0IHdpdGhpbiB0aGUgd2lkZ2V0IGZhY3RvcnkuXHJcbiAgICAgKiBAcGFyYW0gd2lkZ2V0SWQgVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSB3aWRnZXRcclxuICAgICAqIEBwYXJhbSB2ZXJzaW9uIFRoZSB2ZXJzaW9uIG51bWJlciBvZiB0aGUgd2lkZ2V0XHJcbiAgICAgKiBAcGFyYW0gd2lkZ2V0IFRoZSB3aWRnZXQgY29uc3RydWN0b3JcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlZ2lzdGVyKFxyXG4gICAgICAgIHdpZGdldElkOiBzdHJpbmcsXHJcbiAgICAgICAgdmVyc2lvbjogbnVtYmVyLFxyXG4gICAgICAgIHdpZGdldDogbmV3ICguLi5hcmdzKSA9PiBhbnlcclxuICAgICkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyV2l0aE1vZHVsZXMod2lkZ2V0SWQsIHZlcnNpb24sIFtdLCB3aWRnZXQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXJzIHRoZSB3aWRnZXQgd2l0aGluIHRoZSB3aWRnZXQgZmFjdG9yeS5cclxuICAgICAqIFRoaXMgcmVnaXN0cmF0aW9uIGZ1bmN0aW9uIGlzIGZvciBsZWdhY3kgc3VwcG9ydC4gV2Ugc2hvdWxkIGJlIG1vdmluZyBhd2F5IGZyb20gcmVmZXJlbmNlcyBtb2R1bGVzIHRoZSBvbGQgd2F5IChwYXNzaW5nIGluIGFcclxuICAgICAqIHN0cmluZyBhcnJheSBvZiBtb2R1bGUgbmFtZXMgYW5kIGhhdmluZyB0aGUgcGxheWVyL21hbmFnZXIgbG9hZCB0aGVtIGF0IHJ1bnRpbWUpXHJcbiAgICAgKiBAcGFyYW0gd2lkZ2V0SWQgVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSB3aWRnZXRcclxuICAgICAqIEBwYXJhbSB2ZXJzaW9uIFRoZSB2ZXJzaW9uIG51bWJlciBvZiB0aGUgd2lkZ2V0XHJcbiAgICAgKiBAcGFyYW0gbW9kdWxlUmVmcyBBIHN0cmluZyBhcnJheSBjb250YWluaW5nIHRoZSBuYW1lcy92ZXJzaW9ucyBvZiBtb2R1bGVzIHRvIGJlIG1vbmtleSBwYXRjaGVkIG9udG8gdGhlIHdpZGdldCBpbnN0YW5jZS5cclxuICAgICAqIEBwYXJhbSB3aWRnZXQgVGhlIHdpZGdldCBjb25zdHJ1Y3RvclxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVnaXN0ZXJXaXRoTW9kdWxlcyhcclxuICAgICAgICB3aWRnZXRJZDogc3RyaW5nLFxyXG4gICAgICAgIHZlcnNpb246IG51bWJlcixcclxuICAgICAgICBtb2R1bGVSZWZzOiBhbnlbXSxcclxuICAgICAgICB3aWRnZXQ6IG5ldyAoLi4uYXJncykgPT4gYW55XHJcbiAgICApIHtcclxuICAgICAgICBpZiAod2lkZ2V0Lm5hbWUgPT09ICdGYWtlQmFzZScpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXHJcbiAgICAgICAgICAgICAgICAnQ2Fubm90IHJlZ2lzdGVyIGEgd2lkZ2V0IGluc3RhbmNlIHVzaW5nIHRoZSBhYnN0cmFjdCBiYXNlIGNsYXNzLiBSZWdpc3RlciBhIGRlcml2ZWQgd2lkZ2V0IGluc3RlYWQuJ1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgICAgICAnQ2Fubm90IHJlZ2lzdGVyIGEgd2lkZ2V0IGluc3RhbmNlIHVzaW5nIHRoZSBhYnN0cmFjdCBiYXNlIGNsYXNzLiBSZWdpc3RlciBhIGRlcml2ZWQgd2lkZ2V0IGluc3RlYWQuJ1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUGFzcyBpbiBhIGR1bW15IG9iamVjdCBhcyB0aGUgd2lkZ2V0IHRvIGF2b2lkIHRoZSBTb2NpYWxQcm9tb3RlIG1vbmtleSBwYXRjaGluZy4gSXQgd2FzIGEgY3JhcCB3YXkgb2YgZG9pbmcgaXQgYW55d2F5LlxyXG4gICAgICAgIFNvY2lhbFByb21vdGUucmVnaXN0ZXJXaWRnZXQoXHJcbiAgICAgICAgICAgIHdpZGdldElkLFxyXG4gICAgICAgICAgICB2ZXJzaW9uLFxyXG4gICAgICAgICAgICB0aGlzLmNvcmVWZXJzaW9uLFxyXG4gICAgICAgICAgICBtb2R1bGVSZWZzLFxyXG4gICAgICAgICAgICB7fVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gd2lkZ2V0SWQgKyAodmVyc2lvbiA/ICc6JyArIHZlcnNpb24gOiAnJyk7XHJcbiAgICAgICAgY29uc3QgZmFjdG9yeSA9IFNvY2lhbFByb21vdGUuV2lkZ2V0c1trZXldO1xyXG5cclxuICAgICAgICAvLyBXZSBuZWVkIHRvIGV4dGVuZCB0aGUgZmFjdG9yeSBtZXRob2QgaGVyZSB0byBzdXBwb3J0IHByb3BlciBpbmhlcml0YW5jZSAoZm9yIFR5cGVTY3JpcHQgY2xhc3NlcyB0aGF0IHVzZSBpdCksIGJ1dCB3ZSBhbHNvIG5lZWRcclxuICAgICAgICAvLyB0byByZXBsYWNlIHRoZSBGYWtlQmFzZSBiYXNlIGNsYXNzLCBpZiBwcmVzZW50LCB3aXRoIHRoZSBhY3R1YWwgbW9ua2V5IHBhdGNoZWQgcnVudGltZSB3aWRnZXQgaW5zdGFuY2UuXHJcbiAgICAgICAgU29jaWFsUHJvbW90ZS5XaWRnZXRzW2tleV0gPSB3aWRnZXREYXRhID0+IHtcclxuICAgICAgICAgICAgbGV0IHRlbXA6IGFueSA9IHdpZGdldDtcclxuICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRlbXAuX19wcm90b19fLm5hbWUgPT09ICdGYWtlQmFzZScpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wLnByb3RvdHlwZSA9IG5ldyBmYWN0b3J5KHdpZGdldERhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRlbXAgPSB0ZW1wLnByb3RvdHlwZTtcclxuICAgICAgICAgICAgfSB3aGlsZSAodGVtcC5wcm90b3R5cGUgIT0gbnVsbCk7XHJcbiAgICAgICAgICAgIHRlbXAucHJvdG90eXBlID0gbmV3IGZhY3Rvcnkod2lkZ2V0RGF0YSk7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgd2lkZ2V0KHdpZGdldElkLCB2ZXJzaW9uLCB3aWRnZXREYXRhKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLmJpbmRQcm9wZXJ0aWVzKHdpZGdldCwgZmFjdG9yeSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmYWN0b3J5O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXJzIHRoZSB3aWRnZXQgd2l0aGluIHRoZSB3aWRnZXQgZmFjdG9yeS5cclxuICAgICAqIEBwYXJhbSB3aWRnZXRJZCBUaGUgdW5pcXVlIGlkZW50aWZpZXIgb2YgdGhlIHdpZGdldFxyXG4gICAgICogQHBhcmFtIHZlcnNpb24gVGhlIHZlcnNpb24gbnVtYmVyIG9mIHRoZSB3aWRnZXRcclxuICAgICAqIEBwYXJhbSB3aWRnZXQgVGhlIHdpZGdldCBjbGFzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgcmVnaXN0ZXJTaW1wbGUoXHJcbiAgICAgICAgd2lkZ2V0SWQ6IHN0cmluZyxcclxuICAgICAgICB2ZXJzaW9uOiBudW1iZXIsXHJcbiAgICAgICAgd2lkZ2V0OiBuZXcgKC4uLmFyZ3MpID0+IGFueVxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gd2lkZ2V0SWQgKyAodmVyc2lvbiA/ICc6JyArIHZlcnNpb24gOiAnJyk7XHJcbiAgICAgICAgU29jaWFsUHJvbW90ZS5XaWRnZXRzW2tleV0gPSB3aWRnZXQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBiaW5kUHJvcGVydGllcyhcclxuICAgICAgICB3aWRnZXQ6IG5ldyAoLi4uYXJncykgPT4gYW55LFxyXG4gICAgICAgIGZhY3Rvcnk6ICh3aWRnZXREYXRhOiBhbnkpID0+IGFueVxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgZm9yIChjb25zdCBwcm9wZXJ0eUtleSBpbiB3aWRnZXQucHJvdG90eXBlKSB7XHJcbiAgICAgICAgICAgIGlmICh3aWRnZXQucHJvdG90eXBlLmhhc093blByb3BlcnR5KHByb3BlcnR5S2V5KSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoXHJcbiAgICAgICAgICAgICAgICAgICAgd2lkZ2V0LnByb3RvdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGlmIChkZXNjcmlwdG9yLmdldCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBhIHByb3BlcnR5IChhcyBvcHBvc2VkIHRvIGEgZmllbGQpIHNvIHdlIG5lZWQgdG8gcmVzdG9yZSBpdC4gVGhlIFNvY2lhbFByb21vdGUgcmVnaXN0ZXJXaWRnZXQgZnVuY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAvLyBlZmZlY3RpdmVseSBmcmVlemVzIHByb3BlcnRpZXMgYXQgdGhlIHRpbWUgb2YgaXQncyBpbnZvY2F0aW9uLCBieSBjb3B5aW5nIHRoZSBwcm9wZXJ0eSB2YWx1ZSB0byB0aGUgcHJvdG90eXBlXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gKGluc3RlYWQgb2YgcmVkZWZpbmluZyB0aGUgcHJvcGVydHkgdXNpbmcgdGhlIGdldHRlcikuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSGVyZSB3ZSByZWRlZmluZSB0aGUgcHJvcGVydHkgdXNpbmcgdGhlIHByb3BlcnR5IGRlc2NyaXB0b3IuXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGZhY3RvcnkucHJvdG90eXBlW3Byb3BlcnR5S2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnkucHJvdG90eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eUtleSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRvclxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGZhY3RvcnkucHJvdG90eXBlW3Byb3BlcnR5S2V5XSA9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZGdldC5wcm90b3R5cGVbcHJvcGVydHlLZXldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBS0E7QUFDQTtBQUVBOzs7Ozs7OztBQVFBO0FBQ0E7QUFNQTtBQUNBO0FBR0E7QUFHQTtBQUVBO0FBQ0E7QUFPQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBbElBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/core/registration/widget-shim.ts\n");

/***/ }),

/***/ "./src/widgets/scoreboard/v1/scoreboard.ts":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar widget_1 = __webpack_require__(\"./src/core/basewidget/v2/widget.ts\");\r\nvar widget_shim_1 = __webpack_require__(\"./src/core/registration/widget-shim.ts\");\r\nvar widgetShim = new widget_shim_1.WidgetShim(2);\r\nvar Scoreboard = /** @class */ (function (_super) {\r\n    __extends(Scoreboard, _super);\r\n    function Scoreboard(runtimeSettings) {\r\n        return _super.call(this, 'scoreboard', 1, runtimeSettings) || this;\r\n    }\r\n    Scoreboard.prototype.getHTML = function () {\r\n        var id = this.getWidgetName();\r\n        var html = this.getRoot();\r\n        this.wrap = $('<div>')\r\n            .addClass(this.getWidgetName() + \"_wrap\")\r\n            .appendTo(html);\r\n        this.table = $('<table>').appendTo(this.wrap);\r\n        var thead = $('<thead>').appendTo(this.table);\r\n        this.tbody = $('<tbody>').appendTo(this.table);\r\n        var row = $('<tr>').appendTo(thead);\r\n        $(\"<th class=\\\"_col__rank\\\">\" + this.getSetting('label_rank', 'Rank') + \"</th>\").appendTo(row);\r\n        $(\"<th class=\\\"_col__score\\\">\" + this.getSetting('label_score', 'Score') + \"</th>\").appendTo(row);\r\n        if (this.getSetting('show_time_taken') === true) {\r\n            $(\"<th class=\\\"_col__time_taken\\\">\" + this.getSetting('label_time_taken', 'Time Taken') + \"</th>\").appendTo(row);\r\n        }\r\n        $(\"<th class=\\\"\" + id + \"_col__name\\\">\" + this.getSetting('label_name', 'Name') + \"</th>\").appendTo(row);\r\n        return html;\r\n    };\r\n    Scoreboard.prototype.onShow = function () {\r\n        var _this = this;\r\n        this.loadScores().then(function (data) { return _this.renderScores(data); });\r\n    };\r\n    Scoreboard.prototype.getOrdinal = function (n) {\r\n        var s = ['th', 'st', 'nd', 'rd'];\r\n        var v = n % 100;\r\n        return (s[(v - 20) % 10] || s[v] || s[0]);\r\n    };\r\n    Scoreboard.prototype.loadScores = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            if (!_this.inAdmin()) {\r\n                if (!_this.getSessionId() || !_this.getSetting('sessionFilterId')) {\r\n                    return;\r\n                }\r\n                var scoresURL = _this.getAPIUrl() + \"/play/\" + _this.getSessionId() + \"/scoreboard/\" + _this.getSetting('sessionFilterId') + \"?
=\" + _this.getSett
ing('count', 100);\r\n                if (_this.getSetting('allow_duplicates')) {\r\n                    scoresURL += '&allowDuplicates=true';\r\n                }\r\n                $.ajax({\r\n                    url: scoresURL,\r\n                    success: function (d) {\r\n                        resolve(d.scores);\r\n                    },\r\n                    error: function (e) {\r\n                        console.error(e);\r\n                        reject();\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                if (!_this.getSetting('sessionFilterId')) {\r\n                    _this.tbody.empty();\r\n                    $('<span class=\"ccwgt_placeholder\">No Entry for Scoreboard</span>').appendTo(_this.getRoot());\r\n                    reject();\r\n                }\r\n                var placeholders = [];\r\n                var placeholderScore = 2000;\r\n                var chars = 'CATCROWD';\r\n                for (var i = 0; i < _this.getSetting('count'); i++) {\r\n                    var placeholderName = chars.slice(0, 3);\r\n                    chars = chars.substr(3) + placeholderName;\r\n                    placeholders.push({\r\n                        name: placeholderName,\r\n                        score: placeholderScore + '0',\r\n                        timeTaken: placeholderScore,\r\n                        created: 1111111111111\r\n                    });\r\n                    placeholderScore = Math.round(placeholderScore * 0.823);\r\n                }\r\n                resolve(placeholders);\r\n            }\r\n        });\r\n    };\r\n    Scoreboard.prototype.sortByScore = function (scores) {\r\n        return scores.sort(function (a, b) { return ((b.score - a.score) || (a.timeTaken - b.timeTaken)); });\r\n    };\r\n    Scoreboard.prototype.renderScores = function (scores) {\r\n        var id = this.getWidgetName();\r\n        this.tbody.empty();\r\n        var count = this.getSetting('count', 100);\r\n        if (!scores.length) {\r\n            $(\"<div class=\\\"\" + id + \"_placeholder\\\">\" + this.getSetting('label_no_scores', 'No scores yet!') + \"</div>\")\r\n                .appendTo(this.wrap);\r\n        }\r\n        else {\r\n            scores = this.sortByScore(scores);\r\n            for (var i = 0; i < count; i++) {\r\n                if (scores.length <= i) {\r\n                    break;\r\n                }\r\n                var row = $('<tr>');\r\n                var rank = i + 1;\r\n                if (this.getSetting('show_ordinals')) {\r\n                    rank = rank + \"<sup>\" + this.getOrdinal(rank) + \"</sup>\";\r\n                }\r\n                $(\"<td class=\\\"\" + id + \"_col__rank\\\">\")\r\n                    .html(rank.toString())\r\n                    .appendTo(row);\r\n                $(\"<td class=\\\"\" + id + \"_col__score\\\">\")\r\n                    .html(scores[i].score)\r\n                    .appendTo(row);\r\n                if (this.getSetting('show_time_taken') === true) {\r\n                    $(\"<td class=\\\"\" + id + \"_col__time_taken\\\">\")\r\n                        .html(new Date(scores[i].timeTaken).toISOString().slice(11, 19))\r\n                        .appendTo(row);\r\n                }\r\n                $(\"<td class=\\\"\" + id + \"_col__name\\\">\" + scores[i].name + \"</td>\").appendTo(row);\r\n                row.appendTo(this.tbody);\r\n            }\r\n        }\r\n    };\r\n    return Scoreboard;\r\n}(widget_1.Widget));\r\nwidgetShim.registerSimple('scoreboard', 1, Scoreboard);\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvd2lkZ2V0cy9zY29yZWJvYXJkL3YxL3Njb3JlYm9hcmQudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvd2lkZ2V0cy9zY29yZWJvYXJkL3YxL3Njb3JlYm9hcmQudHM/MzVkMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBXaWRnZXRSdW50aW1lT3B0aW9ucyB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL0NvcmUvbW9kZWwvd2lkZ2V0LWFwaS93aWRnZXQtcnVudGltZS1vcHRpb25zLm1vZGVsJztcclxuaW1wb3J0IHsgV2lkZ2V0IH0gZnJvbSAnLi4vLi4vLi4vY29yZS9iYXNld2lkZ2V0L3YyL3dpZGdldCc7XHJcbmltcG9ydCB7IFdpZGdldFNoaW0gfSBmcm9tICcuLi8uLi8uLi9jb3JlL3JlZ2lzdHJhdGlvbi93aWRnZXQtc2hpbSc7XHJcbmltcG9ydCB7IFNjb3JlYm9hcmRJdGVtIH0gZnJvbSAnLi9zY29yZWJvYXJkLWl0ZW0nO1xyXG5pbXBvcnQgeyBTY29yZWJvYXJkU2V0dGluZ3MgfSBmcm9tICcuL3Njb3JlYm9hcmQtc2V0dGluZ3MnO1xyXG5cclxuY29uc3Qgd2lkZ2V0U2hpbSA9IG5ldyBXaWRnZXRTaGltKDIpO1xyXG5cclxuY2xhc3MgU2NvcmVib2FyZCBleHRlbmRzIFdpZGdldDxTY29yZWJvYXJkU2V0dGluZ3M+IHtcclxuICAgIHByaXZhdGUgd3JhcDogSlF1ZXJ5O1xyXG4gICAgcHJpdmF0ZSB0YWJsZTogSlF1ZXJ5O1xyXG4gICAgcHJpdmF0ZSB0Ym9keTogSlF1ZXJ5O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHJ1bnRpbWVTZXR0aW5nczogV2lkZ2V0UnVudGltZU9wdGlvbnMpIHtcclxuICAgICAgICBzdXBlcignc2NvcmVib2FyZCcsIDEsIHJ1bnRpbWVTZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldEhUTUwoKTogSlF1ZXJ5IHtcclxuXHJcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmdldFdpZGdldE5hbWUoKTtcclxuICAgICAgICBjb25zdCBodG1sID0gdGhpcy5nZXRSb290KCk7XHJcblxyXG4gICAgICAgIHRoaXMud3JhcCA9ICQoJzxkaXY+JylcclxuICAgICAgICAgICAgLmFkZENsYXNzKGAke3RoaXMuZ2V0V2lkZ2V0TmFtZSgpfV93cmFwYClcclxuICAgICAgICAgICAgLmFwcGVuZFRvKGh0bWwpO1xyXG5cclxuICAgICAgICB0aGlzLnRhYmxlID0gJCgnPHRhYmxlPicpLmFwcGVuZFRvKHRoaXMud3JhcCk7XHJcbiAgICAgICAgY29uc3QgdGhlYWQgPSAkKCc8dGhlYWQ+JykuYXBwZW5kVG8odGhpcy50YWJsZSk7XHJcbiAgICAgICAgdGhpcy50Ym9keSA9ICQoJzx0Ym9keT4nKS5hcHBlbmRUbyh0aGlzLnRhYmxlKTtcclxuXHJcbiAgICAgICAgY29uc3Qgcm93ID0gJCgnPHRyPicpLmFwcGVuZFRvKHRoZWFkKTtcclxuXHJcbiAgICAgICAgJChgPHRoIGNsYXNzPVwiX2NvbF9fcmFua1wiPiR7dGhpcy5nZXRTZXR0aW5nKCdsYWJlbF9yYW5rJywgJ1JhbmsnKX08L3RoPmApLmFwcGVuZFRvKHJvdyk7XHJcbiAgICAgICAgJChgPHRoIGNsYXNzPVwiX2NvbF9fc2NvcmVcIj4ke3RoaXMuZ2V0U2V0dGluZygnbGFiZWxfc2NvcmUnLCAnU2NvcmUnKX08L3RoPmApLmFwcGVuZFRvKHJvdyk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmdldFNldHRpbmcoJ3Nob3dfdGltZV90YWtlbicpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICQoYDx0aCBjbGFzcz1cIl9jb2xfX3RpbWVfdGFrZW5cIj4ke3RoaXMuZ2V0U2V0dGluZygnbGFiZWxfdGltZV90YWtlbicsICdUaW1lIFRha2VuJyl9PC90aD5gKS5hcHBlbmRUbyhyb3cpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJChgPHRoIGNsYXNzPVwiJHtpZH1fY29sX19uYW1lXCI+JHt0aGlzLmdldFNldHRpbmcoJ2xhYmVsX25hbWUnLCAnTmFtZScpfTwvdGg+YCkuYXBwZW5kVG8ocm93KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGh0bWw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uU2hvdygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmxvYWRTY29yZXMoKS50aGVuKGRhdGEgPT4gdGhpcy5yZW5kZXJTY29yZXMoZGF0YSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0T3JkaW5hbChuOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgICAgIGNvbnN0IHMgPSBbJ3RoJywgJ3N0JywgJ25kJywgJ3JkJ107XHJcbiAgICAgICAgY29uc3QgdiA9IG4gJSAxMDA7XHJcbiAgICAgICAgcmV0dXJuIChzWyh2IC0gMjApICUgMTBdIHx8IHNbdl0gfHwgc1swXSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBsb2FkU2NvcmVzKCk6IFByb21pc2U8U2NvcmVib2FyZEl0ZW1bXT4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxTY29yZWJvYXJkSXRlbVtdPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pbkFkbWluKCkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5nZXRTZXNzaW9uSWQoKSB8fCAhdGhpcy5nZXRTZXR0aW5nKCdzZXNzaW9uRmlsdGVySWQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgc2NvcmVzVVJMID1cclxuICAgICAgICAgICAgICAgICAgICBgJHt0aGlzLmdldEFQSVVybCgpfS9wbGF5LyR7dGhpcy5nZXRTZXNzaW9uSWQoKX0vc2NvcmVib2FyZC8ke3RoaXMuZ2V0U2V0dGluZygnc2Vzc2lvbkZpbHRlcklkJyl9P2NvdW50PSR7dGhpcy5nZXRTZXR0aW5nKCdjb3VudCcsIDEwKX1gO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldFNldHRpbmcoJ2FsbG93X2R1cGxpY2F0ZXMnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3Jlc1VSTCArPSAnJmFsbG93RHVwbGljYXRlcz10cnVlJztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogc2NvcmVzVVJMLFxyXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGQuc2NvcmVzKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLmdldFNldHRpbmcoJ3Nlc3Npb25GaWx0ZXJJZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50Ym9keS5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoJzxzcGFuIGNsYXNzPVwiY2N3Z3RfcGxhY2Vob2xkZXJcIj5ObyBFbnRyeSBmb3IgU2NvcmVib2FyZDwvc3Bhbj4nKS5hcHBlbmRUbyh0aGlzLmdldFJvb3QoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJzOiBTY29yZWJvYXJkSXRlbVtdID0gW107XHJcbiAgICAgICAgICAgICAgICBsZXQgcGxhY2Vob2xkZXJTY29yZSA9IDIwMDA7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2hhcnMgPSAnQ0FUQ1JPV0QnO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5nZXRTZXR0aW5nKCdjb3VudCcpOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlck5hbWUgPSBjaGFycy5zbGljZSgwLCAzKTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFycyA9IGNoYXJzLnN1YnN0cigzKSArIHBsYWNlaG9sZGVyTmFtZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwbGFjZWhvbGRlck5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlOiBwbGFjZWhvbGRlclNjb3JlICsgJzAnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aW1lVGFrZW46IHBsYWNlaG9sZGVyU2NvcmUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQ6IDExMTExMTExMTExMTFcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJTY29yZSA9IE1hdGgucm91bmQocGxhY2Vob2xkZXJTY29yZSAqIDAuODIzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHBsYWNlaG9sZGVycyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNvcnRCeVNjb3JlKHNjb3JlczogU2NvcmVib2FyZEl0ZW1bXSk6IFNjb3JlYm9hcmRJdGVtW10ge1xyXG4gICAgICAgIHJldHVybiBzY29yZXMuc29ydCgoYTogYW55LCBiOiBhbnkpID0+ICgoYi5zY29yZSAtIGEuc2NvcmUpIHx8IChhLnRpbWVUYWtlbiAtIGIudGltZVRha2VuKSkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyU2NvcmVzKHNjb3JlczogU2NvcmVib2FyZEl0ZW1bXSk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5nZXRXaWRnZXROYW1lKCk7XHJcbiAgICAgICAgdGhpcy50Ym9keS5lbXB0eSgpO1xyXG5cclxuICAgICAgICBjb25zdCBjb3VudCA9IHRoaXMuZ2V0U2V0dGluZygnY291bnQnLCAxMCk7XHJcblxyXG4gICAgICAgIGlmICghc2NvcmVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAkKGA8ZGl2IGNsYXNzPVwiJHtpZH1fcGxhY2Vob2xkZXJcIj4ke3RoaXMuZ2V0U2V0dGluZygnbGFiZWxfbm9fc2NvcmVzJywgJ05vIHNjb3JlcyB5ZXQhJyl9PC9kaXY+YClcclxuICAgICAgICAgICAgICAgIC5hcHBlbmRUbyh0aGlzLndyYXApO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICBzY29yZXMgPSB0aGlzLnNvcnRCeVNjb3JlKHNjb3Jlcyk7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChzY29yZXMubGVuZ3RoIDw9IGkpIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3cgPSAkKCc8dHI+Jyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmFuazogc3RyaW5nIHwgbnVtYmVyID0gaSArIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2V0U2V0dGluZygnc2hvd19vcmRpbmFscycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmFuayA9IGAke3Jhbmt9PHN1cD4ke3RoaXMuZ2V0T3JkaW5hbChyYW5rKX08L3N1cD5gO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICQoYDx0ZCBjbGFzcz1cIiR7aWR9X2NvbF9fcmFua1wiPmApXHJcbiAgICAgICAgICAgICAgICAgICAgLmh0bWwocmFuay50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhyb3cpO1xyXG5cclxuICAgICAgICAgICAgICAgICQoYDx0ZCBjbGFzcz1cIiR7aWR9X2NvbF9fc2NvcmVcIj5gKVxyXG4gICAgICAgICAgICAgICAgICAgIC5odG1sKHNjb3Jlc1tpXS5zY29yZSlcclxuICAgICAgICAgICAgICAgICAgICAuYXBwZW5kVG8ocm93KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRTZXR0aW5nKCdzaG93X3RpbWVfdGFrZW4nKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICQoYDx0ZCBjbGFzcz1cIiR7aWR9X2NvbF9fdGltZV90YWtlblwiPmApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5odG1sKG5ldyBEYXRlKHNjb3Jlc1tpXS50aW1lVGFrZW4pLnRvSVNPU3RyaW5nKCkuc2xpY2UoMTEsIDE5KSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZFRvKHJvdyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJChgPHRkIGNsYXNzPVwiJHtpZH1fY29sX19uYW1lXCI+JHtzY29yZXNbaV0ubmFtZX08L3RkPmApLmFwcGVuZFRvKHJvdyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcm93LmFwcGVuZFRvKHRoaXMudGJvZHkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG53aWRnZXRTaGltLnJlZ2lzdGVyU2ltcGxlKCdzY29yZWJvYXJkJywgMSwgU2NvcmVib2FyZCk7XHJcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQ0E7QUFDQTtBQUlBO0FBRUE7QUFBQTtBQUtBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/widgets/scoreboard/v1/scoreboard.ts\n");

/***/ })

/******/ });
